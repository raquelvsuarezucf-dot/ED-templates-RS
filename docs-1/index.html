<!DOCTYPE html>
<html lang="en" class="h-full" data-authed="1"><head>

  <meta charset="utf-8">

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>RVSRED Templates — Macros</title>

  <meta name="description" content="Emergency Medicine documentation macros — local only. No PHI stored.">

  <meta name="theme-color" content="#0f2640">

  <meta name="color-scheme" content="light">

  <!-- Preboot: show app immediately if already authenticated (no flicker) -->

  <script>

    (function () {

      try {

        if (localStorage.getItem('rvsred.auth') === '1') {

          document.documentElement.dataset.authed = '1';

        }

      } catch (e) {}

    })();

  </script>

  <script src="https://cdn.tailwindcss.com"></script>

  <script>

    tailwind.config = {

      theme: {

        extend: {

          colors: {

            primary: { DEFAULT: '#1E70C1', 500: '#3A8BE0', 700: '#0f2640' },

            ink: '#0f2640', bg1: '#eaf1fb', bg2: '#dbe7f6', muted: '#5b6b84'

          },

          boxShadow: { soft: '0 10px 28px rgba(15,38,64,.08)' },

          borderRadius: { '2xl': '1rem' }

        }

      }

    }

  </script>

  <style>

    :root { color-scheme: light }

    @media (prefers-reduced-motion: reduce){*{animation:none!important;transition:none!important}}

    /* Focus + small helpers */

    .focus-ring:focus-visible{outline:3px solid #3A8BE0; outline-offset:2px; border-radius:.75rem}

    /* Toast */

    .toast-pop{transform:translateY(8px);opacity:0}

    .toast-pop.show{transform:translateY(0);opacity:1;transition:transform .2s,opacity .2s}

    /* Light BLUE behind macro text blocks */

    .macro-body{ white-space:pre-wrap; background-color: rgb(219 231 246 / 0.55); }

    details>summary::-webkit-details-marker{display:none}

    .chip{padding:.375rem .75rem;border-radius:.75rem;border:1px solid #e2e8f0;background:#fff;font-size:.75rem}

    .chip:hover{background:#f8fafc}

    /* layout */

    .app-grid{display:grid; grid-template-columns: 280px 1fr; gap: 16px}

    @media (max-width: 1024px){ .app-grid{grid-template-columns: 1fr} #sidebar{position:static; height:auto} }

    #sidebar{position:sticky; top:64px; height: calc(100dvh - 80px); overflow:auto}

    #grid{display:flex; flex-direction:column; gap:16px}

    .drop-target{border:1px dashed transparent}

    .drop-target.dragover{border-color:#3A8BE0; background:rgba(58,139,224,0.06)}

    /* Settings menu */

    .menu{display:none}

    .menu.open{display:block}

    /* ---------- Auth screen styles ---------- */

    #login {

      display: none; /* default hidden; shown if not authed via rule below */

    }

    html:not([data-authed="1"]) #login { display: grid }

    html:not([data-authed="1"]) #app   { opacity: 0; pointer-events: none; user-select: none }

    html[data-authed="1"] #login { display: none }

    /* Fade-in for app when switching to authed */

    #app { transition: opacity .28s ease; }

    /* Nice subtle backdrop gradient for login */

    .login-bg {

      background: radial-gradient(1200px 600px at 10% -10%, rgba(58,139,224,.18), transparent 60%),

                  radial-gradient(1000px 500px at 110% 110%, rgba(30,112,193,.18), transparent 60%),

                  linear-gradient(180deg, #eaf1fb 0%, #dbe7f6 100%);

    }

  </style>

  <!-- Favicon -->

  <link rel="icon" href="data:image/svg+xml;utf8,

    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 128 128&quot;&gt;

      &lt;defs&gt;&lt;linearGradient id=&quot;g&quot; x1=&quot;0&quot; x2=&quot;1&quot; y1=&quot;0&quot; y2=&quot;1&quot;&gt;&lt;stop offset=&quot;0%&quot; stop-color=&quot;%231E70C1&quot;/&gt;&lt;stop offset=&quot;100%&quot; stop-color=&quot;%233A8BE0&quot;/&gt;&lt;/linearGradient&gt;&lt;/defs&gt;

      &lt;rect width=&quot;128&quot; height=&quot;128&quot; rx=&quot;24&quot; fill=&quot;url(%23g)&quot;/&gt;

      &lt;g fill=&quot;%23fff&quot; font-family=&quot;Arial, Helvetica, sans-serif&quot; font-weight=&quot;700&quot;&gt;

        &lt;text x=&quot;64&quot; y=&quot;74&quot; font-size=&quot;52&quot; text-anchor=&quot;middle&quot;&gt;RVS&lt;/text&gt;

      &lt;/g&gt;

    &lt;/svg&gt;">

<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.left-1\/2{left:50%}.right-0{right:0px}.right-3{right:0.75rem}.top-0{top:0px}.top-2\.5{top:0.625rem}.top-4{top:1rem}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.-mt-0\.5{margin-top:-0.125rem}.mb-3{margin-bottom:0.75rem}.mt-1{margin-top:0.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:0.5rem}.mt-20{margin-top:5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.ml-2{margin-left:0.5rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-6{height:1.5rem}.h-full{height:100%}.max-h-\[70vh\]{max-height:70vh}.w-10{width:2.5rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-\[min\(420px\2c 92vw\)\]{width:min(420px,92vw)}.w-\[min\(680px\2c 92vw\)\]{width:min(680px,92vw)}.w-\[min\(860px\2c 94vw\)\]{width:min(860px,94vw)}.w-\[min\(900px\2c 94vw\)\]{width:min(900px,94vw)}.w-full{width:100%}.min-w-0{min-width:0px}.max-w-screen-2xl{max-width:1536px}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.flex-wrap{flex-wrap:wrap}.place-items-center{place-items:center}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-1{gap:0.25rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.break-words{overflow-wrap:break-word}.rounded-2xl{border-radius:1rem}.rounded-xl{border-radius:0.75rem}.rounded-full{border-radius:9999px}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-200\/70{border-color:rgb(226 232 240 / 0.7)}.bg-bg1{--tw-bg-opacity:1;background-color:rgb(234 241 251 / var(--tw-bg-opacity, 1))}.bg-bg1\/80{background-color:rgb(234 241 251 / 0.8)}.bg-black\/40{background-color:rgb(0 0 0 / 0.4)}.bg-ink{--tw-bg-opacity:1;background-color:rgb(15 38 64 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(30 112 193 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-bg2\/60{background-color:rgb(219 231 246 / 0.6)}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.from-primary{--tw-gradient-from:#1E70C1 var(--tw-gradient-from-position);--tw-gradient-to:rgb(30 112 193 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-primary-500{--tw-gradient-to:#3A8BE0 var(--tw-gradient-to-position)}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-5{padding:1.25rem}.p-4{padding:1rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.pr-12{padding-right:3rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-\[13\.5px\]{font-size:13.5px}.text-base{font-size:1rem;line-height:1.5rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-5{line-height:1.25rem}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wide{letter-spacing:0.025em}.text-ink{--tw-text-opacity:1;color:rgb(15 38 64 / var(--tw-text-opacity, 1))}.text-muted{--tw-text-opacity:1;color:rgb(91 107 132 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.opacity-60{opacity:0.6}.shadow-soft{--tw-shadow:0 10px 28px rgba(15,38,64,.08);--tw-shadow-colored:0 10px 28px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.hover\:bg-primary\/90:hover{background-color:rgb(30 112 193 / 0.9)}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style>
<!-- Mobile + Settings menu fix (non-destructive) -->
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<style>
  /* Keep text readable and prevent overflow on phones */
  @media (max-width: 640px){
    html{-webkit-text-size-adjust:100%}
    .prose pre, pre{white-space:pre-wrap; word-break:break-word}
    .card, .panel{max-width:100%}
  }
  /* Ensure dropdown can float above everything */
  .rvs-settings-float{position:fixed !important; right:1rem !important; top:3.75rem !important;
    left:auto !important; z-index:9999 !important; max-height:min(70vh,520px); overflow:auto;
    transform:none !important;}
</style>
<script>
(function(){
  // Attach after DOM ready so we can find the Settings trigger
  function ready(fn){ if(document.readyState!=="loading") fn(); else document.addEventListener("DOMContentLoaded", fn); }
  ready(function(){
    // Find a button or element that displays "Settings"
    var triggers = Array.from(document.querySelectorAll('button, [role="button"], .btn, .menu-button, [data-settings]'));
    var settingsBtn = triggers.find(function(el){ return el && /(^|\s)settings(\s|$)/i.test(el.textContent || ""); });
    if(!settingsBtn){ return; }

    function floatMenu(){
      // Look for an open menu that likely contains our items (Save Site / Sync to Repo Now)
      var candidates = Array.from(document.body.querySelectorAll('div,ul,menu'));
      var menu = candidates.find(function(el){
        if (!el || el === settingsBtn) return false;
        var s = getComputedStyle(el);
        if (s.display === 'none' || el.offsetParent === null) return false;
        var txt = (el.textContent || '').toLowerCase();
        return (s.position === 'absolute' || s.position === 'fixed') &&
               txt.includes('save site') &&
               txt.includes('sync to repo now');
      });
      if(!menu) return;

      // Position relative to button viewport location
      var r = settingsBtn.getBoundingClientRect();
      menu.classList.add('rvs-settings-float');
      // place it just below the button with a small gap
      menu.style.top = (Math.round(r.bottom + 8 + window.scrollY)) + 'px';
      menu.style.right = (Math.max(16, window.innerWidth - Math.round(r.right))) + 'px';
    }

    // Run after each click on the Settings button and short delay for open animation
    settingsBtn.addEventListener('click', function(){
      setTimeout(floatMenu, 60);
    }, true);

    // Also re-float on window resize/orientation changes
    window.addEventListener('resize', function(){ setTimeout(floatMenu, 60); });
    window.addEventListener('orientationchange', function(){ setTimeout(floatMenu, 120); });
  });
})();
</script>

<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.left-1\/2{left:50%}.right-0{right:0px}.right-3{right:0.75rem}.top-0{top:0px}.top-2\.5{top:0.625rem}.top-4{top:1rem}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.-mt-0\.5{margin-top:-0.125rem}.mb-3{margin-bottom:0.75rem}.ml-2{margin-left:0.5rem}.mt-1{margin-top:0.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:0.5rem}.mt-20{margin-top:5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.mt-24{margin-top:6rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-6{height:1.5rem}.h-full{height:100%}.max-h-\[70vh\]{max-height:70vh}.w-10{width:2.5rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-\[min\(420px\2c 92vw\)\]{width:min(420px,92vw)}.w-\[min\(680px\2c 92vw\)\]{width:min(680px,92vw)}.w-\[min\(860px\2c 94vw\)\]{width:min(860px,94vw)}.w-\[min\(900px\2c 94vw\)\]{width:min(900px,94vw)}.w-full{width:100%}.w-\[min\(720px\2c calc\(100vw-2rem\)\)\]{width:min(720px,calc(100vw - 2rem))}.min-w-0{min-width:0px}.max-w-screen-2xl{max-width:1536px}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-wrap{flex-wrap:wrap}.place-items-center{place-items:center}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.break-words{overflow-wrap:break-word}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-200\/70{border-color:rgb(226 232 240 / 0.7)}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.bg-bg1{--tw-bg-opacity:1;background-color:rgb(234 241 251 / var(--tw-bg-opacity, 1))}.bg-bg1\/80{background-color:rgb(234 241 251 / 0.8)}.bg-bg2\/60{background-color:rgb(219 231 246 / 0.6)}.bg-black\/40{background-color:rgb(0 0 0 / 0.4)}.bg-ink{--tw-bg-opacity:1;background-color:rgb(15 38 64 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(30 112 193 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-black\/30{background-color:rgb(0 0 0 / 0.3)}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.from-primary{--tw-gradient-from:#1E70C1 var(--tw-gradient-from-position);--tw-gradient-to:rgb(30 112 193 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-primary-500{--tw-gradient-to:#3A8BE0 var(--tw-gradient-to-position)}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pr-12{padding-right:3rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-\[13\.5px\]{font-size:13.5px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-5{line-height:1.25rem}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wide{letter-spacing:0.025em}.text-ink{--tw-text-opacity:1;color:rgb(15 38 64 / var(--tw-text-opacity, 1))}.text-muted{--tw-text-opacity:1;color:rgb(91 107 132 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.accent-primary{accent-color:#1E70C1}.opacity-60{opacity:0.6}.shadow-soft{--tw-shadow:0 10px 28px rgba(15,38,64,.08);--tw-shadow-colored:0 10px 28px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.hover\:bg-primary\/90:hover{background-color:rgb(30 112 193 / 0.9)}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style><style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.left-1\/2{left:50%}.right-0{right:0px}.right-3{right:0.75rem}.top-0{top:0px}.top-2\.5{top:0.625rem}.top-4{top:1rem}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.-mt-0\.5{margin-top:-0.125rem}.mb-3{margin-bottom:0.75rem}.ml-2{margin-left:0.5rem}.mt-1{margin-top:0.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:0.5rem}.mt-20{margin-top:5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.mt-24{margin-top:6rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-6{height:1.5rem}.h-full{height:100%}.max-h-\[70vh\]{max-height:70vh}.w-10{width:2.5rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-\[min\(420px\2c 92vw\)\]{width:min(420px,92vw)}.w-\[min\(680px\2c 92vw\)\]{width:min(680px,92vw)}.w-\[min\(860px\2c 94vw\)\]{width:min(860px,94vw)}.w-\[min\(900px\2c 94vw\)\]{width:min(900px,94vw)}.w-full{width:100%}.w-\[min\(720px\2c calc\(100vw-2rem\)\)\]{width:min(720px,calc(100vw - 2rem))}.min-w-0{min-width:0px}.max-w-screen-2xl{max-width:1536px}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-wrap{flex-wrap:wrap}.place-items-center{place-items:center}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.break-words{overflow-wrap:break-word}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-200\/70{border-color:rgb(226 232 240 / 0.7)}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.bg-bg1{--tw-bg-opacity:1;background-color:rgb(234 241 251 / var(--tw-bg-opacity, 1))}.bg-bg1\/80{background-color:rgb(234 241 251 / 0.8)}.bg-bg2\/60{background-color:rgb(219 231 246 / 0.6)}.bg-black\/40{background-color:rgb(0 0 0 / 0.4)}.bg-ink{--tw-bg-opacity:1;background-color:rgb(15 38 64 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(30 112 193 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-black\/30{background-color:rgb(0 0 0 / 0.3)}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.from-primary{--tw-gradient-from:#1E70C1 var(--tw-gradient-from-position);--tw-gradient-to:rgb(30 112 193 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-primary-500{--tw-gradient-to:#3A8BE0 var(--tw-gradient-to-position)}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pr-12{padding-right:3rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-\[13\.5px\]{font-size:13.5px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-5{line-height:1.25rem}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wide{letter-spacing:0.025em}.text-ink{--tw-text-opacity:1;color:rgb(15 38 64 / var(--tw-text-opacity, 1))}.text-muted{--tw-text-opacity:1;color:rgb(91 107 132 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.accent-primary{accent-color:#1E70C1}.opacity-60{opacity:0.6}.shadow-soft{--tw-shadow:0 10px 28px rgba(15,38,64,.08);--tw-shadow-colored:0 10px 28px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.hover\:bg-primary\/90:hover{background-color:rgb(30 112 193 / 0.9)}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style><style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.left-1\/2{left:50%}.right-0{right:0px}.right-3{right:0.75rem}.top-0{top:0px}.top-2\.5{top:0.625rem}.top-4{top:1rem}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.-mt-0\.5{margin-top:-0.125rem}.mb-3{margin-bottom:0.75rem}.ml-2{margin-left:0.5rem}.mt-1{margin-top:0.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:0.5rem}.mt-20{margin-top:5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.mt-24{margin-top:6rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-6{height:1.5rem}.h-full{height:100%}.max-h-\[70vh\]{max-height:70vh}.w-10{width:2.5rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-\[min\(420px\2c 92vw\)\]{width:min(420px,92vw)}.w-\[min\(680px\2c 92vw\)\]{width:min(680px,92vw)}.w-\[min\(860px\2c 94vw\)\]{width:min(860px,94vw)}.w-\[min\(900px\2c 94vw\)\]{width:min(900px,94vw)}.w-full{width:100%}.w-\[min\(720px\2c calc\(100vw-2rem\)\)\]{width:min(720px,calc(100vw - 2rem))}.min-w-0{min-width:0px}.max-w-screen-2xl{max-width:1536px}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.-translate-x-1\/2{--tw-translate-x:-50%;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-wrap{flex-wrap:wrap}.place-items-center{place-items:center}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.break-words{overflow-wrap:break-word}.rounded-2xl{border-radius:1rem}.rounded-full{border-radius:9999px}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-200\/70{border-color:rgb(226 232 240 / 0.7)}.border-slate-300{--tw-border-opacity:1;border-color:rgb(203 213 225 / var(--tw-border-opacity, 1))}.bg-bg1{--tw-bg-opacity:1;background-color:rgb(234 241 251 / var(--tw-bg-opacity, 1))}.bg-bg1\/80{background-color:rgb(234 241 251 / 0.8)}.bg-bg2\/60{background-color:rgb(219 231 246 / 0.6)}.bg-black\/40{background-color:rgb(0 0 0 / 0.4)}.bg-ink{--tw-bg-opacity:1;background-color:rgb(15 38 64 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(30 112 193 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-black\/30{background-color:rgb(0 0 0 / 0.3)}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.from-primary{--tw-gradient-from:#1E70C1 var(--tw-gradient-from-position);--tw-gradient-to:rgb(30 112 193 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-primary-500{--tw-gradient-to:#3A8BE0 var(--tw-gradient-to-position)}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.pr-12{padding-right:3rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-\[13\.5px\]{font-size:13.5px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-5{line-height:1.25rem}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wide{letter-spacing:0.025em}.text-ink{--tw-text-opacity:1;color:rgb(15 38 64 / var(--tw-text-opacity, 1))}.text-muted{--tw-text-opacity:1;color:rgb(91 107 132 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-slate-800{--tw-text-opacity:1;color:rgb(30 41 59 / var(--tw-text-opacity, 1))}.accent-primary{accent-color:#1E70C1}.opacity-60{opacity:0.6}.shadow-soft{--tw-shadow:0 10px 28px rgba(15,38,64,.08);--tw-shadow-colored:0 10px 28px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.hover\:bg-primary\/90:hover{background-color:rgb(30 112 193 / 0.9)}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}@media (min-width: 768px){.md\:col-span-2{grid-column:span 2 / span 2}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style></head>

<body class="h-full bg-bg1 text-ink">

  <!-- ================= AUTH SCREEN (clean, no tips) ================= -->

  <section id="login" class="fixed inset-0 z-50 login-bg place-items-center">

    <div class="w-[min(420px,92vw)] rounded-2xl bg-white shadow-soft border border-slate-200 p-5">

      <div class="flex items-center gap-3 mb-3">

        <div class="shrink-0 flex items-center justify-center w-10 h-10 rounded-2xl bg-gradient-to-br from-primary to-primary-500 text-white font-bold">RVS</div>

        <div>

          <h1 class="text-xl font-semibold tracking-tight">RVSRED Templates</h1>

          <p class="text-sm text-muted -mt-0.5">Sign in to continue</p>

        </div>

      </div>

      <form id="loginForm" class="space-y-3" autocomplete="off" novalidate="">

        <label class="block">

          <span class="text-sm text-muted">Username</span>

          <input id="loginUser" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" inputmode="latin" autocapitalize="none" autocomplete="username" required="">

        </label>

        <label class="block">

          <span class="text-sm text-muted">Password</span>

          <input id="loginPass" type="password" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" autocomplete="current-password" required="">

        </label>

        <div class="flex items-center justify-between">

          <div aria-live="polite" class="text-sm text-red-600" id="loginError" style="min-height:1.25rem">Invalid username or password.</div>

          <button id="loginBtn" class="focus-ring px-4 py-2 rounded-xl bg-primary text-white hover:bg-primary/90">Sign in</button>

        </div>

      </form>

      <p class="text-xs text-muted mt-3">Local-only • Nothing leaves your browser</p>

    </div>

  </section>

  <!-- ================= END AUTH SCREEN ================= -->

  <!-- =================== APP =================== -->

  <div id="toast" role="status" aria-live="polite" class="fixed left-1/2 -translate-x-1/2 top-4 z-50 px-4 py-2 rounded-xl bg-ink text-white text-sm shadow-soft toast-pop" style="display: none;">Site saved (index.html downloaded)</div>

  <!-- Choose modal -->

  <div id="modal" class="fixed inset-0 z-40 hidden" aria-modal="true" role="dialog" aria-labelledby="modal-title">

    <div class="absolute inset-0 bg-black/40"></div>

    <div class="relative mx-auto mt-20 w-[min(680px,92vw)] rounded-2xl bg-white p-5 shadow-soft">

      <h2 id="modal-title" class="text-lg font-semibold mb-3">Choose a macro</h2>

      <div id="modal-content" class="space-y-2"></div>

      <div class="mt-4 flex justify-end gap-2">

        <button id="modal-cancel" class="focus-ring px-3 py-2 rounded-xl border border-slate-200">Close</button>

      </div>

    </div>

  </div>

  <!-- Catalog modal -->

  <div id="catalogModal" class="fixed inset-0 z-40 hidden" aria-modal="true" role="dialog" aria-labelledby="catalog-title">

    <div class="absolute inset-0 bg-black/40"></div>

    <div class="relative mx-auto mt-10 w-[min(900px,94vw)] rounded-2xl bg-white p-5 shadow-soft">

      <div class="flex items-center justify-between">

        <h2 id="catalog-title" class="text-lg font-semibold mb-3">Macro Catalog — grouped by Category &amp; Subcategory</h2>

        <div class="flex gap-2">

          <button id="catalogPrint" class="focus-ring px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Print</button>

          <button id="catalogClose" class="focus-ring px-3 py-2 rounded-xl border border-slate-200 text-sm">Close</button>

        </div>

      </div>

      <div id="catalog-content" class="max-h-[70vh] overflow-auto text-sm leading-5"></div>

    </div>

  </div>

  <!-- Edit modal -->

  <div id="editModal" class="fixed inset-0 z-40 hidden" aria-modal="true" role="dialog" aria-labelledby="edit-title">

    <div class="absolute inset-0 bg-black/40"></div>

    <div class="relative mx-auto mt-10 w-[min(860px,94vw)] rounded-2xl bg-white p-5 shadow-soft">

      <h2 id="edit-title" class="text-lg font-semibold mb-3">Edit macro</h2>

      <form id="editForm" class="space-y-3">

        <div class="grid sm:grid-cols-2 gap-3">

          <label class="block"><span class="text-sm text-muted">Title</span><input id="editTitle" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" required=""></label>

          <label class="block"><span class="text-sm text-muted">Category</span>

            <select id="editCategory" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2"><option>Pediatrics</option><option>Adult</option><option>Communication</option></select>

          </label>

          <label class="block"><span class="text-sm text-muted">Subcategory</span><input id="editSubcat" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" placeholder="Viral, Trauma, Hyperbili, Hand-offs, Consults"></label>

          <label class="block"><span class="text-sm text-muted">Dot-phrase</span><input id="editDot" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2" placeholder=".alias"></label>

          <label class="block"><span class="text-sm text-muted">Pin</span>

            <select id="editPinned" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2"><option value="false">No</option><option value="true">Yes</option></select>

          </label>

        </div>

        <label class="block"><span class="text-sm text-muted">Body</span><textarea id="editBody" rows="12" class="focus-ring mt-1 w-full rounded-xl border border-slate-200 px-3 py-2 font-mono"></textarea></label>

        <div class="flex justify-end gap-2 pt-2">

          <button type="button" id="editCancel" class="focus-ring px-3 py-2 rounded-xl border border-slate-200">Cancel</button>

          <button type="submit" class="focus-ring px-4 py-2 rounded-xl bg-primary text-white hover:bg-primary/90">Save</button>

        </div>

      </form>

    </div>

  </div>

  <div id="app">

    <header class="sticky top-0 z-30 backdrop-blur bg-bg1/80 border-b border-slate-200/70">

      <div class="mx-auto max-w-screen-2xl px-4 py-3">

        <div class="flex items-center gap-3">

          <div class="shrink-0 flex items-center justify-center w-10 h-10 rounded-2xl bg-gradient-to-br from-primary to-primary-500 text-white font-bold shadow-soft select-none">RVS</div>

          <div class="flex-1">

            <h1 class="text-xl font-semibold tracking-tight">RVSRED Templates</h1>

            <p class="text-sm text-muted -mt-0.5">Local-only macros • Searchable • Dot-phrase copy • Drag &amp; drop to organize</p>

          </div>

          <!-- Settings menu button -->

          <div class="relative">

            <button id="settingsBtn" class="focus-ring px-3 py-2 rounded-xl bg-primary text-white hover:bg-primary/90 text-sm" aria-haspopup="true" aria-expanded="true" aria-controls="settingsMenu">Settings ▾</button>

            <div id="settingsMenu" role="menu" aria-labelledby="settingsBtn" class="menu absolute right-0 mt-2 w-52 rounded-2xl border border-slate-200 bg-white shadow-soft p-2 rvs-settings-float open" style="top: 61px; right: 31px;">

              <button id="exportBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">Export JSON</button>

              <label role="menuitem" class="focus-ring w-full block text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm cursor-pointer">Import JSON<input id="importInput" type="file" accept="application/json" class="hidden"></label>

              <button id="saveSiteBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">Save Site</button>

              <button id="catalogBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">Catalog</button>

              <button id="resetSeedBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">Reset Data</button>
              <div class="my-1 border-t border-slate-200"></div>

              <button id="repoSettingsBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">Repository Settings…</button>
              <button id="syncNowBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">Sync to Repo Now</button>
              <label role="menuitem" class="focus-ring w-full text-left flex items-center gap-2 px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">
                <input id="syncOnSaveToggle" type="checkbox" class="accent-primary">
                <span>Sync on Save</span>
              </label>


              <div class="my-1 border-t border-slate-200"></div>

              <button id="addBtn" role="menuitem" class="focus-ring w-full text-left px-3 py-2 rounded-xl hover:bg-slate-50 text-sm">New Macro</button>

            <div style="border-top: 1px solid rgba(15, 38, 64, 0.08); margin: 0.5rem 0px;"></div><button type="button" style="display: block; width: 100%; text-align: left; padding: 0.5rem 0.75rem; border-radius: 0.75rem; cursor: pointer; border: 1px solid transparent; background: transparent;">Force Sync (Auto‑SHA)</button><div style="border-top: 1px solid rgba(15, 38, 64, 0.08); margin: 0.5rem 0px;"></div><button type="button" style="display: block; width: 100%; text-align: left; padding: 0.5rem 0.75rem; border-radius: 0.75rem; cursor: pointer; border: 1px solid transparent;">Force Sync (Auto‑SHA)</button><div style="border-top: 1px solid rgba(15, 38, 64, 0.08); margin: 0.5rem 0px;"></div><button type="button" style="display: block; width: 100%; text-align: left; padding: 0.5rem 0.75rem; border-radius: 0.75rem; cursor: pointer; border: 1px solid transparent;">Force Sync (Auto‑SHA)</button></div>

          </div>

        </div>

        <div class="mt-3">

          <div class="relative">

            <input id="search" class="focus-ring w-full rounded-2xl border border-slate-200 bg-white px-4 py-2.5 pr-12 shadow-soft" placeholder="Search…  Tip: type .alias for live preview, Enter to copy" aria-label="Search macros">

            <svg class="absolute right-3 top-2.5 h-6 w-6 opacity-60" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.3-4.3" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><circle cx="10" cy="10" r="6" stroke="currentColor" stroke-width="2"></circle></svg>

          </div>

        </div>

      </div>

    </header>

    <main class="mx-auto max-w-screen-2xl px-4 py-6 app-grid">

      <!-- LEFT MENU -->

      <aside id="sidebar" class="rounded-2xl bg-white border border-slate-200 shadow-soft p-3" aria-label="Categories">

        <h2 class="text-sm font-semibold text-ink px-2">Categories</h2>

        <div id="side-groups" class="mt-2 space-y-3"><div>

          <div class="px-2 pt-2 text-xs uppercase tracking-wide text-muted">Pediatrics</div>

          <div class="mt-1 space-y-1" role="list"><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Pediatrics::Viral"><span>Viral</span><span class="text-xs text-muted ml-2">4</span></button><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Pediatrics::Trauma"><span>Trauma</span><span class="text-xs text-muted ml-2">3</span></button><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Pediatrics::Hyperbili"><span>Hyperbili</span><span class="text-xs text-muted ml-2">3</span></button><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Pediatrics::Unsorted"><span>Unsorted</span><span class="text-xs text-muted ml-2">2</span></button></div></div><div>

          <div class="px-2 pt-2 text-xs uppercase tracking-wide text-muted">Adult</div>

          <div class="mt-1 space-y-1" role="list"><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Adult::Unsorted"><span>Unsorted</span><span class="text-xs text-muted ml-2">1</span></button></div></div><div>

          <div class="px-2 pt-2 text-xs uppercase tracking-wide text-muted">Communication</div>

          <div class="mt-1 space-y-1" role="list"><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Communication::Hand-offs"><span>Hand-offs</span><span class="text-xs text-muted ml-2">2</span></button><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Communication::Consults"><span>Consults</span><span class="text-xs text-muted ml-2">0</span></button><button class="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between" data-sub="Communication::Unsorted"><span>Unsorted</span><span class="text-xs text-muted ml-2">0</span></button></div></div></div>

        <p class="text-xs text-muted mt-3 px-2">Tip: drag a card onto a subcategory to move it.</p>

      </aside>

      <!-- RIGHT STACKED LIST -->

      <section>

        <div class="grid gap-2 sm:grid-cols-2">

          <details class="rounded-2xl border border-slate-200 bg-white p-3">

            <summary class="focus-ring flex items-center justify-between cursor-pointer select-none">

              <span class="font-medium">Pediatrics</span>

              <span class="text-xs text-muted" id="count-Pediatrics">12</span>

            </summary>

            <div class="mt-3 flex flex-wrap gap-2">

              <button class="chip focus-ring" data-sub="Pediatrics::Viral">Viral</button>

              <button class="chip focus-ring" data-sub="Pediatrics::Trauma">Trauma</button>

              <button class="chip focus-ring" data-sub="Pediatrics::Hyperbili">Hyperbili</button>

              <button class="chip focus-ring" data-sub="Pediatrics::Unsorted">Unsorted</button>

            </div>

          </details>

          <details class="rounded-2xl border border-slate-200 bg-white p-3" open="">

            <summary class="focus-ring flex items-center justify-between cursor-pointer select-none">

              <span class="font-medium">Adult</span>

              <span class="text-xs text-muted" id="count-Adult">1</span>

            </summary>

            <div class="mt-3 flex flex-wrap gap-2">

              <button class="chip focus-ring" data-sub="Adult::Unsorted">Unsorted</button>

            </div>

          </details>

          <details class="rounded-2xl border border-slate-200 bg-white p-3">

            <summary class="focus-ring flex items-center justify-between cursor-pointer select-none">

              <span class="font-medium">Communication</span>

              <span class="text-xs text-muted" id="count-Communication">2</span>

            </summary>

            <div class="mt-3 flex flex-wrap gap-2">

              <button class="chip focus-ring" data-sub="Communication::Hand-offs">Hand-offs</button>

              <button class="chip focus-ring" data-sub="Communication::Consults">Consults</button>

              <button class="chip focus-ring" data-sub="Communication::Unsorted">Unsorted</button>

            </div>

          </details>

        </div>

        <section id="grid" class="mt-4"><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">MDM — Pediatric Viral / Febrile Illness</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Viral</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedsviral</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">[age]-year-old [sex] presented to the ED with [duration] of fever and associated [symptoms: cough, nasal congestion, rhinorrhea, decreased appetite, irritability]. Parent present at bedside reports patient has been tolerating PO without difficulties, with [no / mild] decrease in appetite and normal urine output. Denies vomiting, diarrhea, rash, or respiratory distress. Immunizations are up to date.
On evaluation, patient appeared well hydrated, interactive, and appropriate for age, with normal capillary refill and no increased work of breathing. Oropharynx clear, tympanic membranes without bulging or erythema, lungs clear to auscultation, and abdomen soft, non-tender, and non-distended.
Differential includes viral upper respiratory infection, early otitis media, influenza, RSV, COVID-19, and early pneumonia, though there were no focal findings to strongly suggest a bacterial source. Findings today are most consistent with a viral process. [COVID, influenza, and RSV tests were negative / pending / positive for ___ / not obtained.]
Patient remained comfortable and interactive throughout the ED visit with stable vital signs and reassuring physical findings. Findings reviewed with the parent at bedside, and supportive care discussed, including weight-based acetaminophen or ibuprofen for fever and encouraging fluids as tolerated. Parent verbalized understanding and was comfortable with the plan for discharge and outpatient follow-up.
Strict return precautions discussed, including persistent fever, respiratory distress, poor oral intake, vomiting, decreased urine output, new rash, or any new or concerning symptoms. Follow-up with pediatrician advised within 48–72 hours or sooner if symptoms worsen.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Pediatric Streptococcal Pharyngitis</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Viral</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedsstrep</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">[age]-year-old [sex] presented to the ED with [duration] of sore throat associated with [symptoms: fever, decreased appetite, odynophagia, mild cough / no cough, nasal congestion]. Parent present at bedside reports patient has been tolerating PO intake [well / poorly] and maintaining normal urine output. Denies vomiting, drooling, neck stiffness, or respiratory distress. Immunizations are up to date.
On exam, patient appeared well hydrated, interactive, and nontoxic. Oropharyngeal exam notable for [tonsillar erythema / exudates / palatal petechiae / none], uvula midline, and no evidence of peritonsillar swelling or trismus. Cervical nodes [tender / non-tender, enlarged / not enlarged]. Lungs clear to auscultation and no meningeal signs or rash observed.
Differential includes streptococcal pharyngitis, viral pharyngitis, early tonsillitis, and mononucleosis, with low concern for peritonsillar abscess, epiglottitis, or retropharyngeal infection given the reassuring airway exam and overall well appearance. Findings today are most consistent with [streptococcal / viral] pharyngitis. [Rapid strep test positive / negative / pending; throat culture sent / not obtained.] [COVID, influenza, and RSV tests negative / positive for ___ / not obtained.]
For confirmed or suspected streptococcal infection, prescribed [amoxicillin / cephalexin / azithromycin] — weight-based dosing — with instructions to complete the full course. Supportive care discussed, including acetaminophen or ibuprofen for fever or throat pain, maintaining hydration, and soft foods as tolerated.
Patient remained comfortable and interactive throughout the ED visit with stable vital signs and reassuring physical findings. Findings reviewed with the parent at bedside, who verbalized understanding and was comfortable with the plan for discharge and outpatient follow-up.
Strict return precautions discussed, including persistent fever, worsening throat pain, drooling, difficulty swallowing or breathing, neck swelling, or any new or concerning symptoms. Follow-up with pediatrician advised within 48–72 hours or sooner if symptoms worsen.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">MDM — Pediatric Otitis Media</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Viral</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedsaom</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">[age]-year-old [sex] presented to the ED with [duration] of ear pain associated with [symptoms: fever, nasal congestion, cough, irritability, decreased appetite]. Parent present at bedside reports patient has been tolerating PO intake [well / poorly] with normal urinary output. Denies vomiting, drainage from the ear, rash, or respiratory distress. Immunizations are up to date.
On exam, patient appeared well hydrated and interactive for age. Right / left tympanic membrane noted to be [erythematous / bulging / dull / effusion present / normal]; no mastoid tenderness, auricular swelling, or drainage. Contralateral ear within normal limits. Lungs clear to auscultation, and oropharynx without erythema or exudate. Neck supple with full range of motion and no lymphadenopathy. Abdomen soft and non-tender.
Differential includes acute otitis media, otitis externa, eustachian tube dysfunction, and viral upper respiratory infection. Findings today are most consistent with [acute otitis media / serous otitis / viral URI with referred ear pain]. [COVID, influenza, and RSV tests negative / positive for ___ / not obtained.]
If bacterial:
 Antibiotic therapy initiated with [amoxicillin / cefdinir / azithromycin], weight-based, and first dose given in the ED. Supportive care discussed with parent, including acetaminophen or ibuprofen for pain or fever, and maintaining hydration. If symptoms fail to improve or worsen despite treatment, advised prompt re-evaluation.
If non-bacterial / watchful waiting:
 Findings reviewed with parent at bedside. Presentation may represent early or serous otitis rather than acute bacterial infection; advised supportive care with acetaminophen or ibuprofen as needed and close follow-up if symptoms persist or worsen.
Patient remained comfortable and interactive throughout the ED visit with stable vital signs and reassuring physical findings. Findings and plan reviewed with parent at bedside, who verbalized understanding and was comfortable with discharge and outpatient follow-up.
Strict return precautions discussed, including persistent fever, worsening ear pain, drainage from the ear, vomiting, lethargy, poor oral intake, new rash, neck stiffness, or any new or concerning symptoms. Follow-up with pediatrician advised within 48–72 hours or sooner if symptoms worsen.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Pediatric Pneumonia — MDM Template</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Viral</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedspna</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">Patient presented with [cough / fever / shortness of breath / malaise] for [duration] prior to arrival. Parent present at bedside reports [persistent cough / decreased appetite / mild fatigue / increased work of breathing] with [no vomiting / no lethargy / no rash]. On exam, patient was alert, interactive, and behaving appropriately for age. Lungs revealed [focal crackles / diminished breath sounds / rhonchi / mild wheezing], with [no retractions / no nasal flaring / normal oxygen saturation]. Findings otherwise reassuring, with no signs of respiratory distress or dehydration.
Differential includes viral pneumonia, bacterial pneumonia, bronchiolitis, asthma or reactive airway exacerbation, and upper respiratory infection. Findings today are most consistent with [bacterial / viral] pneumonia based on clinical picture and [chest x-ray results / auscultatory findings].
Findings and imaging were consistent with [bacterial / viral] pneumonia. Patient was [prescribed / given] [amoxicillin / azithromycin / cefdinir], weight-based, for outpatient treatment. Supportive care discussed with parent at bedside, including acetaminophen or ibuprofen for fever control and encouraging fluids as tolerated. [Continued with prescribed albuterol as needed.] Parent verbalized understanding and was comfortable with the plan for discharge and follow-up.
Return precautions discussed, including but not limited to: worsening or persistent fever, increased work of breathing, chest pain, vomiting, lethargy, poor oral intake, cyanosis, or any new or concerning symptoms. Advised follow-up with pediatrician within 48–72 hours for reassessment or sooner if symptoms worsen.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Communication sign out</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Communication</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Hand-offs</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .signout</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">Patient signed out to [Dr. _____] at [time] with pending [labs / imaging / re-evaluation]. Clinical course and current status reviewed in detail. Disposition options discussed and plan of care conveyed to the receiving provider, who will follow pending results and determine final disposition. Patient remained stable at time of sign-out.`</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Communication signin</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Communication</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Hand-offs</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .signin</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">Patient received in sign-out from [Dr. _____] at [time] with pending [results / re-evaluation / consults]. Prior ED course, findings, and disposition considerations reviewed. Assuming ongoing care and final disposition.`</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">PECARN — No CT, No Observation</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Trauma</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedspecarn1</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">MDM — Pediatric Head Trauma (No CT, No Observation)

PECARN CALCULATIONS:
Age group: [&lt;2 years / ≥2 years]
Mechanism of injury: [describe]
PECARN ciTBI estimated risk:
    &lt;2 years: &lt;0.02 %
    ≥2 years: &lt;0.05 %
All predictors negative:
    - Normal mental status, GCS 15
    - No loss of consciousness (≥2 y: any; &lt;2 y: ≥5 s)
    - No palpable or basilar skull fracture
    - No non-frontal scalp hematoma (&lt;2 y)
    - No vomiting, severe headache, or severe mechanism

---

Patient presented after minor head trauma with no loss of consciousness, vomiting, or abnormal behavior. On examination, child appeared well, alert, and interactive for age with normal tone, strength, and coordination. Pupils equal and reactive; no scalp hematoma or tenderness; no step-off or signs of basilar skull fracture. Vitals stable and age-appropriate. No focal neurologic deficits.

Based on the PECARN decision rule, patient meets very-low-risk criteria for clinically important traumatic brain injury (estimated risk &lt;0.05%). Given the absence of concerning features and a reassuring neurologic exam, no head CT or prolonged observation is indicated. Discussed the extremely low probability of intracranial injury and risks associated with radiation exposure with the parent, who agreed with home observation. All questions answered and expectations reviewed.

Patient remained well-appearing and interactive during ED course. Discharged home with strict return precautions for persistent vomiting, worsening headache, confusion, seizure, focal deficits, lethargy, or poor oral intake. Advised follow-up with pediatrician within 48 hours or sooner if concerns arise.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">PECARN — No CT, Observation</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Trauma</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedspecarn2</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">MDM — Pediatric Head Trauma (Observation without CT)

PECARN CALCULATIONS:
Age group: [&lt;2 years / ≥2 years]  
Mechanism of injury: [describe]  
PECARN ciTBI estimated risk:  
 &lt; 2 years ≈ 0.9 %  ≥ 2 years ≈ 0.8 %  
Low-risk group with intermediate factor(s): [list specific factor(s)]  
 - Normal mental status / GCS 15  
 - No palpable or basilar skull fracture  
 - No signs of focal neurologic deficit  
 - May have isolated vomiting / brief LOC / mild headache / frontal hematoma  
 - Mechanism not severe  

---

Patient presented after minor head trauma with [brief loss of consciousness / single vomit / mild headache] and otherwise normal behavior per caregiver. Exam revealed a well-appearing, interactive child with normal pupils, tone, strength, and coordination. No skull tenderness or step-off appreciated; tympanic membranes clear; no basilar signs. Vitals stable and appropriate for age.

Using the PECARN rule, patient falls within the low-risk “observation” zone (&lt; 1 % risk for ciTBI). Given the absence of high-risk findings and reassuring exam, CT was deferred in favor of ED observation with serial neurologic assessments. Family counseled regarding small residual risk of intracranial injury versus radiation exposure from CT, and agreed with observation.

Patient observed in the ED for [__ hours] with stable vitals, normal serial neuro exams, and no further vomiting or changes in behavior. Findings remained reassuring. Discussed warning signs and need for prompt return if headache, vomiting, confusion, seizure, lethargy, or any new neurologic deficits develop. Discharged home in stable condition with follow-up arranged with pediatrician within 24–48 hours.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">PECARN — CT Recommended</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Trauma</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .pedspecarn3</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">MDM — Pediatric Head Trauma (CT Recommended)

PECARN CALCULATIONS:
Age group: [&lt;2 years / ≥2 years]  
Mechanism of injury: [describe]  
PECARN ciTBI estimated risk:  
 &lt; 2 years ≈ 4.4 %  ≥ 2 years ≈ 4.3 %  
High-risk feature(s) present: [list specific findings]  
 - Abnormal mental status or GCS &lt; 15 at 2 hours  
 - Palpable skull fracture (&lt; 2 y) / Signs of basilar skull fracture (≥ 2 y)  
 - Severe mechanism (fall &gt; 3 ft &lt; 2 y / &gt; 5 ft ≥ 2 y; pedestrian / bicyclist struck; high-impact object)  
 - Repeated vomiting / severe headache  
 - Any focal neuro deficit or seizure  

---

Patient presented after [mechanism] with [concerning symptom: vomiting, altered mental status, skull defect, or severe headache]. On arrival, GCS [15 / less if applicable]; pupils equal and reactive; no significant external bleeding. Exam revealed [palpable frontal step-off / battle sign / periorbital ecchymosis / hematoma description]. Neurologic exam otherwise intact. Vitals stable.

By PECARN criteria, presence of [high-risk finding] places patient in the imaging pathway with ≈4 % risk for ciTBI. Discussed the evidence-based recommendation for head CT to exclude intracranial injury and reviewed the benefits and radiation risks with the parent. Consent obtained for imaging after shared decision-making.

Patient remained hemodynamically stable and interactive while awaiting CT. Imaging [negative / demonstrated ___]. If negative, findings consistent with minor head injury without intracranial pathology; family counseled on home observation and return precautions. If positive, neurosurgery and pediatrics consulted for management and admission as indicated. All results and follow-up instructions reviewed with caregiver who verbalized understanding.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">BILI — Below Phototherapy Threshold (No Phototherapy)</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Hyperbili</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .bili1</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">MDM — Neonatal Hyperbilirubinemia (Below Phototherapy Threshold)

BILIRUBIN CALCULATIONS / RISK FACTORS:
Age at sampling: [__ hours] Gestational age: [__ weeks + __ days] Birth weight: [__ g]  
Feeding / weight loss: [breast / formula ; __ % loss]  
AAP 2022 Risk Factors: [none / GA &lt; 38 w / isoimmune hemolysis / G6PD / sepsis / albumin &lt; 3.0 / bruising or cephalohematoma]  
Measurements: TSB [__ mg/dL] at [__ h] Phototherapy threshold [__ mg/dL] Δ to threshold = [__ mg/dL] (below)  
Exchange threshold [__ mg/dL] Risk curve / percentile [__]

---

Infant evaluated for neonatal jaundice at [__ hours] of life. Well appearing, alert, and feeding [adequately / improving] with stable vitals and no evidence of lethargy, poor tone, or dehydration. No scleral icterus beyond mild facial/chest jaundice. TSB of [__ mg/dL] is below the AAP phototherapy threshold of [__ mg/dL] for gestational age and risk profile, placing infant in the low-risk zone for clinically significant hyperbilirubinemia.

Findings consistent with physiologic jaundice. Discussed expected bilirubin course and importance of frequent feeds to optimize enteric clearance. Family educated on return precautions for poor feeding, lethargy, dark urine, acholic stools, or worsening jaundice to the lower extremities. Plan for repeat bilirubin check within 24–48 hours and close pediatric follow-up. Caregivers verbalized understanding and comfort with home observation.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">BILI — Phototherapy Initiated</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Hyperbili</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .bili2</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">MDM — Neonatal Hyperbilirubinemia (Phototherapy Initiated)

BILIRUBIN CALCULATIONS / RISK FACTORS:
Age at sampling: [__ hours] Gestational age: [__ weeks + __ days] Birth weight: [__ g]  
AAP 2022 Risk Factors: [GA &lt; 38 w / isoimmune hemolysis / G6PD / sepsis / albumin &lt; 3.0 / other]  
Measurements: TSB [__ mg/dL] at [__ h] Phototherapy threshold [__ mg/dL] Δ to threshold = [__ mg/dL] (at/above)  
Exchange threshold [__ mg/dL] Rate of rise (if known) [__ mg/dL/hr]

---

Infant presented with progressive jaundice; on exam alert and interactive with normal tone and suck. No signs of acute bilirubin encephalopathy. Serum bilirubin above AAP phototherapy threshold for age and risk factors. No dehydration or clinical signs of infection.

Initiated intensive phototherapy using LED blue lights with maximized body surface exposure and eye protection in place. Encouraged frequent feeds to enhance bilirubin elimination and monitored intake/output. No signs of hemolysis or cephalohematoma requiring additional intervention. Family counseled on treatment course, expected timeline for decline in TSB, and need for serial levels to confirm response.

Patient tolerated therapy well with stable vitals and improving jaundice trend. Plan for TSB recheck in 4–6 hours to confirm decrease, continue phototherapy until TSB is &gt; 2 mg/dL below threshold and trending down. If criteria met, phototherapy to be stopped with rebound TSB draw 6–12 hours later as indicated. Parents informed of follow-up requirements and return precautions.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">BILI — Escalation / Exchange Threshold Consult</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Hyperbili</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: .bili3</span>

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">MDM — Neonatal Hyperbilirubinemia (Escalation / Exchange Threshold)

BILIRUBIN CALCULATIONS / RISK FACTORS:
Age at sampling: [__ hours] Gestational age: [__ weeks + __ days] Birth weight: [__ g]  
Risk Factors: [isoimmune hemolysis / G6PD / sepsis / albumin &lt; 3.0 / GA &lt; 38 w / other]  
Measurements: TSB [__ mg/dL] at [__ h] Phototherapy threshold [__ mg/dL] Exchange threshold [__ mg/dL]  
Δ to exchange = [__ mg/dL] (≥ 0 = at/above) Rate of rise [__ mg/dL/hr]

---

Infant with known hyperbilirubinemia on intensive phototherapy demonstrating TSB at or above the AAP exchange threshold. Examination shows alertness with slightly diminished tone but no overt signs of acute bilirubin encephalopathy. Vitals stable, feeding adequate. IV access established and volume status addressed.

Given TSB [__ mg/dL] at [__ hours] of life and Δ to exchange of [__ mg/dL], consulted Neonatology / NICU for escalation of care and potential exchange transfusion. Additional labs obtained including blood type, DAT/Coombs, CBC/retic, bilirubin fractionation, albumin, and G6PD level. If isoimmune hemolysis present, considered IVIG per AAP protocol. Supportive care continued with maximal phototherapy and temperature monitoring.

Discussed clinical status and risk of bilirubin neurotoxicity with caregivers; family understood need for NICU-level management and possible exchange procedure. Patient remained hemodynamically stable during transfer preparations.</pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Untitled macro</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Adult</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Unsorted</span>

              

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto"></pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Untitled macro</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Unsorted</span>

              

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto"></pre></article><article class="rounded-2xl bg-white border border-slate-200 shadow-soft p-4" draggable="true" aria-grabbed="false">

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">Untitled macro</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">Pediatrics</span>

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Unsorted</span>

              

              

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto"></pre></article></section>

        <div id="empty" class="mt-10 text-center text-muted hidden">

          <p class="text-lg font-medium">No macros match your filters.</p>

          <p class="text-sm">Try a different search/category, or clear the search box.</p>

        </div>

      </section>

    </main>

    <footer class="mt-8 border-t border-slate-200">

      <div class="mx-auto max-w-screen-2xl px-4 py-6 text-xs text-muted"><p>LocalStorage only • Nothing leaves your browser • © RVSRED</p></div>

    </footer>

  </div>

  <!-- ================= END APP ================= -->

  <!-- EMBEDDED DATA (UNCHANGED) -->

  <script id="embedded-data" type="application/json">[
  {
    "id": "peds-viral",
    "title": "MDM — Pediatric Viral / Febrile Illness",
    "category": "Pediatrics",
    "subcategory": "Viral",
    "dot": ".pedsviral",
    "body": "[age]-year-old [sex] presented to the ED with [duration] of fever and associated [symptoms: cough, nasal congestion, rhinorrhea, decreased appetite, irritability]. Parent present at bedside reports patient has been tolerating PO without difficulties, with [no / mild] decrease in appetite and normal urine output. Denies vomiting, diarrhea, rash, or respiratory distress. Immunizations are up to date.\nOn evaluation, patient appeared well hydrated, interactive, and appropriate for age, with normal capillary refill and no increased work of breathing. Oropharynx clear, tympanic membranes without bulging or erythema, lungs clear to auscultation, and abdomen soft, non-tender, and non-distended.\nDifferential includes viral upper respiratory infection, early otitis media, influenza, RSV, COVID-19, and early pneumonia, though there were no focal findings to strongly suggest a bacterial source. Findings today are most consistent with a viral process. [COVID, influenza, and RSV tests were negative / pending / positive for ___ / not obtained.]\nPatient remained comfortable and interactive throughout the ED visit with stable vital signs and reassuring physical findings. Findings reviewed with the parent at bedside, and supportive care discussed, including weight-based acetaminophen or ibuprofen for fever and encouraging fluids as tolerated. Parent verbalized understanding and was comfortable with the plan for discharge and outpatient follow-up.\nStrict return precautions discussed, including persistent fever, respiratory distress, poor oral intake, vomiting, decreased urine output, new rash, or any new or concerning symptoms. Follow-up with pediatrician advised within 48–72 hours or sooner if symptoms worsen.",
    "createdAt": 1761533643268,
    "updatedAt": 1761533643268
  },
  {
    "id": "peds-strep",
    "title": "Pediatric Streptococcal Pharyngitis",
    "category": "Pediatrics",
    "subcategory": "Viral",
    "dot": ".pedsstrep",
    "body": "[age]-year-old [sex] presented to the ED with [duration] of sore throat associated with [symptoms: fever, decreased appetite, odynophagia, mild cough / no cough, nasal congestion]. Parent present at bedside reports patient has been tolerating PO intake [well / poorly] and maintaining normal urine output. Denies vomiting, drooling, neck stiffness, or respiratory distress. Immunizations are up to date.\nOn exam, patient appeared well hydrated, interactive, and nontoxic. Oropharyngeal exam notable for [tonsillar erythema / exudates / palatal petechiae / none], uvula midline, and no evidence of peritonsillar swelling or trismus. Cervical nodes [tender / non-tender, enlarged / not enlarged]. Lungs clear to auscultation and no meningeal signs or rash observed.\nDifferential includes streptococcal pharyngitis, viral pharyngitis, early tonsillitis, and mononucleosis, with low concern for peritonsillar abscess, epiglottitis, or retropharyngeal infection given the reassuring airway exam and overall well appearance. Findings today are most consistent with [streptococcal / viral] pharyngitis. [Rapid strep test positive / negative / pending; throat culture sent / not obtained.] [COVID, influenza, and RSV tests negative / positive for ___ / not obtained.]\nFor confirmed or suspected streptococcal infection, prescribed [amoxicillin / cephalexin / azithromycin] — weight-based dosing — with instructions to complete the full course. Supportive care discussed, including acetaminophen or ibuprofen for fever or throat pain, maintaining hydration, and soft foods as tolerated.\nPatient remained comfortable and interactive throughout the ED visit with stable vital signs and reassuring physical findings. Findings reviewed with the parent at bedside, who verbalized understanding and was comfortable with the plan for discharge and outpatient follow-up.\nStrict return precautions discussed, including persistent fever, worsening throat pain, drooling, difficulty swallowing or breathing, neck swelling, or any new or concerning symptoms. Follow-up with pediatrician advised within 48–72 hours or sooner if symptoms worsen.",
    "createdAt": 1761533643269,
    "updatedAt": 1761533643269
  },
  {
    "id": "peds-aom",
    "title": "MDM — Pediatric Otitis Media",
    "category": "Pediatrics",
    "subcategory": "Viral",
    "dot": ".pedsaom",
    "body": "[age]-year-old [sex] presented to the ED with [duration] of ear pain associated with [symptoms: fever, nasal congestion, cough, irritability, decreased appetite]. Parent present at bedside reports patient has been tolerating PO intake [well / poorly] with normal urinary output. Denies vomiting, drainage from the ear, rash, or respiratory distress. Immunizations are up to date.\nOn exam, patient appeared well hydrated and interactive for age. Right / left tympanic membrane noted to be [erythematous / bulging / dull / effusion present / normal]; no mastoid tenderness, auricular swelling, or drainage. Contralateral ear within normal limits. Lungs clear to auscultation, and oropharynx without erythema or exudate. Neck supple with full range of motion and no lymphadenopathy. Abdomen soft and non-tender.\nDifferential includes acute otitis media, otitis externa, eustachian tube dysfunction, and viral upper respiratory infection. Findings today are most consistent with [acute otitis media / serous otitis / viral URI with referred ear pain]. [COVID, influenza, and RSV tests negative / positive for ___ / not obtained.]\nIf bacterial:\n Antibiotic therapy initiated with [amoxicillin / cefdinir / azithromycin], weight-based, and first dose given in the ED. Supportive care discussed with parent, including acetaminophen or ibuprofen for pain or fever, and maintaining hydration. If symptoms fail to improve or worsen despite treatment, advised prompt re-evaluation.\nIf non-bacterial / watchful waiting:\n Findings reviewed with parent at bedside. Presentation may represent early or serous otitis rather than acute bacterial infection; advised supportive care with acetaminophen or ibuprofen as needed and close follow-up if symptoms persist or worsen.\nPatient remained comfortable and interactive throughout the ED visit with stable vital signs and reassuring physical findings. Findings and plan reviewed with parent at bedside, who verbalized understanding and was comfortable with discharge and outpatient follow-up.\nStrict return precautions discussed, including persistent fever, worsening ear pain, drainage from the ear, vomiting, lethargy, poor oral intake, new rash, neck stiffness, or any new or concerning symptoms. Follow-up with pediatrician advised within 48–72 hours or sooner if symptoms worsen.",
    "createdAt": 1761533643270,
    "updatedAt": 1761533643270
  },
  {
    "id": "peds-pna",
    "title": "Pediatric Pneumonia — MDM Template",
    "category": "Pediatrics",
    "subcategory": "Viral",
    "dot": ".pedspna",
    "body": "Patient presented with [cough / fever / shortness of breath / malaise] for [duration] prior to arrival. Parent present at bedside reports [persistent cough / decreased appetite / mild fatigue / increased work of breathing] with [no vomiting / no lethargy / no rash]. On exam, patient was alert, interactive, and behaving appropriately for age. Lungs revealed [focal crackles / diminished breath sounds / rhonchi / mild wheezing], with [no retractions / no nasal flaring / normal oxygen saturation]. Findings otherwise reassuring, with no signs of respiratory distress or dehydration.\nDifferential includes viral pneumonia, bacterial pneumonia, bronchiolitis, asthma or reactive airway exacerbation, and upper respiratory infection. Findings today are most consistent with [bacterial / viral] pneumonia based on clinical picture and [chest x-ray results / auscultatory findings].\nFindings and imaging were consistent with [bacterial / viral] pneumonia. Patient was [prescribed / given] [amoxicillin / azithromycin / cefdinir], weight-based, for outpatient treatment. Supportive care discussed with parent at bedside, including acetaminophen or ibuprofen for fever control and encouraging fluids as tolerated. [Continued with prescribed albuterol as needed.] Parent verbalized understanding and was comfortable with the plan for discharge and follow-up.\nReturn precautions discussed, including but not limited to: worsening or persistent fever, increased work of breathing, chest pain, vomiting, lethargy, poor oral intake, cyanosis, or any new or concerning symptoms. Advised follow-up with pediatrician within 48–72 hours for reassessment or sooner if symptoms worsen.",
    "createdAt": 1761533643271,
    "updatedAt": 1761533643271
  },
  {
    "id": "comms-signout",
    "title": "Communication sign out",
    "category": "Communication",
    "subcategory": "Hand-offs",
    "dot": ".signout",
    "body": "Patient signed out to [Dr. _____] at [time] with pending [labs / imaging / re-evaluation]. Clinical course and current status reviewed in detail. Disposition options discussed and plan of care conveyed to the receiving provider, who will follow pending results and determine final disposition. Patient remained stable at time of sign-out.`",
    "createdAt": 1761533643272,
    "updatedAt": 1761533643272
  },
  {
    "id": "comms-signin",
    "title": "Communication signin",
    "category": "Communication",
    "subcategory": "Hand-offs",
    "dot": ".signin",
    "body": "Patient received in sign-out from [Dr. _____] at [time] with pending [results / re-evaluation / consults]. Prior ED course, findings, and disposition considerations reviewed. Assuming ongoing care and final disposition.`",
    "createdAt": 1761533643273,
    "updatedAt": 1761533643273
  },
  {
    "id": "pecarn-no-ct-no-observation",
    "title": "PECARN — No CT, No Observation",
    "category": "Pediatrics",
    "subcategory": "Trauma",
    "dot": ".pedspecarn1",
    "body": "MDM — Pediatric Head Trauma (No CT, No Observation)\n\nPECARN CALCULATIONS:\nAge group: [<2 years / ≥2 years]\nMechanism of injury: [describe]\nPECARN ciTBI estimated risk:\n    <2 years: <0.02 %\n    ≥2 years: <0.05 %\nAll predictors negative:\n    - Normal mental status, GCS 15\n    - No loss of consciousness (≥2 y: any; <2 y: ≥5 s)\n    - No palpable or basilar skull fracture\n    - No non-frontal scalp hematoma (<2 y)\n    - No vomiting, severe headache, or severe mechanism\n\n---\n\nPatient presented after minor head trauma with no loss of consciousness, vomiting, or abnormal behavior. On examination, child appeared well, alert, and interactive for age with normal tone, strength, and coordination. Pupils equal and reactive; no scalp hematoma or tenderness; no step-off or signs of basilar skull fracture. Vitals stable and age-appropriate. No focal neurologic deficits.\n\nBased on the PECARN decision rule, patient meets very-low-risk criteria for clinically important traumatic brain injury (estimated risk <0.05%). Given the absence of concerning features and a reassuring neurologic exam, no head CT or prolonged observation is indicated. Discussed the extremely low probability of intracranial injury and risks associated with radiation exposure with the parent, who agreed with home observation. All questions answered and expectations reviewed.\n\nPatient remained well-appearing and interactive during ED course. Discharged home with strict return precautions for persistent vomiting, worsening headache, confusion, seizure, focal deficits, lethargy, or poor oral intake. Advised follow-up with pediatrician within 48 hours or sooner if concerns arise.",
    "createdAt": 1761533643274,
    "updatedAt": 1761546565433,
    "pinned": false
  },
  {
    "id": "pecarn-no-ct-observation",
    "title": "PECARN — No CT, Observation",
    "category": "Pediatrics",
    "subcategory": "Trauma",
    "dot": ".pedspecarn2",
    "body": "MDM — Pediatric Head Trauma (Observation without CT)\n\nPECARN CALCULATIONS:\nAge group: [<2 years / ≥2 years]  \nMechanism of injury: [describe]  \nPECARN ciTBI estimated risk:  \n < 2 years ≈ 0.9 %  ≥ 2 years ≈ 0.8 %  \nLow-risk group with intermediate factor(s): [list specific factor(s)]  \n - Normal mental status / GCS 15  \n - No palpable or basilar skull fracture  \n - No signs of focal neurologic deficit  \n - May have isolated vomiting / brief LOC / mild headache / frontal hematoma  \n - Mechanism not severe  \n\n---\n\nPatient presented after minor head trauma with [brief loss of consciousness / single vomit / mild headache] and otherwise normal behavior per caregiver. Exam revealed a well-appearing, interactive child with normal pupils, tone, strength, and coordination. No skull tenderness or step-off appreciated; tympanic membranes clear; no basilar signs. Vitals stable and appropriate for age.\n\nUsing the PECARN rule, patient falls within the low-risk “observation” zone (< 1 % risk for ciTBI). Given the absence of high-risk findings and reassuring exam, CT was deferred in favor of ED observation with serial neurologic assessments. Family counseled regarding small residual risk of intracranial injury versus radiation exposure from CT, and agreed with observation.\n\nPatient observed in the ED for [__ hours] with stable vitals, normal serial neuro exams, and no further vomiting or changes in behavior. Findings remained reassuring. Discussed warning signs and need for prompt return if headache, vomiting, confusion, seizure, lethargy, or any new neurologic deficits develop. Discharged home in stable condition with follow-up arranged with pediatrician within 24–48 hours.",
    "createdAt": 1761533643275,
    "updatedAt": 1761546574015,
    "pinned": false
  },
  {
    "id": "pecarn-ct-recommended",
    "title": "PECARN — CT Recommended",
    "category": "Pediatrics",
    "subcategory": "Trauma",
    "dot": ".pedspecarn3",
    "body": "MDM — Pediatric Head Trauma (CT Recommended)\n\nPECARN CALCULATIONS:\nAge group: [<2 years / ≥2 years]  \nMechanism of injury: [describe]  \nPECARN ciTBI estimated risk:  \n < 2 years ≈ 4.4 %  ≥ 2 years ≈ 4.3 %  \nHigh-risk feature(s) present: [list specific findings]  \n - Abnormal mental status or GCS < 15 at 2 hours  \n - Palpable skull fracture (< 2 y) / Signs of basilar skull fracture (≥ 2 y)  \n - Severe mechanism (fall > 3 ft < 2 y / > 5 ft ≥ 2 y; pedestrian / bicyclist struck; high-impact object)  \n - Repeated vomiting / severe headache  \n - Any focal neuro deficit or seizure  \n\n---\n\nPatient presented after [mechanism] with [concerning symptom: vomiting, altered mental status, skull defect, or severe headache]. On arrival, GCS [15 / less if applicable]; pupils equal and reactive; no significant external bleeding. Exam revealed [palpable frontal step-off / battle sign / periorbital ecchymosis / hematoma description]. Neurologic exam otherwise intact. Vitals stable.\n\nBy PECARN criteria, presence of [high-risk finding] places patient in the imaging pathway with ≈4 % risk for ciTBI. Discussed the evidence-based recommendation for head CT to exclude intracranial injury and reviewed the benefits and radiation risks with the parent. Consent obtained for imaging after shared decision-making.\n\nPatient remained hemodynamically stable and interactive while awaiting CT. Imaging [negative / demonstrated ___]. If negative, findings consistent with minor head injury without intracranial pathology; family counseled on home observation and return precautions. If positive, neurosurgery and pediatrics consulted for management and admission as indicated. All results and follow-up instructions reviewed with caregiver who verbalized understanding.",
    "createdAt": 1761533643276,
    "updatedAt": 1761546583270,
    "pinned": false
  },
  {
    "id": "bili-below-threshold",
    "title": "BILI — Below Phototherapy Threshold (No Phototherapy)",
    "category": "Pediatrics",
    "subcategory": "Hyperbili",
    "dot": ".bili1",
    "body": "MDM — Neonatal Hyperbilirubinemia (Below Phototherapy Threshold)\n\nBILIRUBIN CALCULATIONS / RISK FACTORS:\nAge at sampling: [__ hours] Gestational age: [__ weeks + __ days] Birth weight: [__ g]  \nFeeding / weight loss: [breast / formula ; __ % loss]  \nAAP 2022 Risk Factors: [none / GA < 38 w / isoimmune hemolysis / G6PD / sepsis / albumin < 3.0 / bruising or cephalohematoma]  \nMeasurements: TSB [__ mg/dL] at [__ h] Phototherapy threshold [__ mg/dL] Δ to threshold = [__ mg/dL] (below)  \nExchange threshold [__ mg/dL] Risk curve / percentile [__]\n\n---\n\nInfant evaluated for neonatal jaundice at [__ hours] of life. Well appearing, alert, and feeding [adequately / improving] with stable vitals and no evidence of lethargy, poor tone, or dehydration. No scleral icterus beyond mild facial/chest jaundice. TSB of [__ mg/dL] is below the AAP phototherapy threshold of [__ mg/dL] for gestational age and risk profile, placing infant in the low-risk zone for clinically significant hyperbilirubinemia.\n\nFindings consistent with physiologic jaundice. Discussed expected bilirubin course and importance of frequent feeds to optimize enteric clearance. Family educated on return precautions for poor feeding, lethargy, dark urine, acholic stools, or worsening jaundice to the lower extremities. Plan for repeat bilirubin check within 24–48 hours and close pediatric follow-up. Caregivers verbalized understanding and comfort with home observation.",
    "createdAt": 1761533643277,
    "updatedAt": 1761533708380,
    "pinned": false
  },
  {
    "id": "bili-phototherapy",
    "title": "BILI — Phototherapy Initiated",
    "category": "Pediatrics",
    "subcategory": "Hyperbili",
    "dot": ".bili2",
    "body": "MDM — Neonatal Hyperbilirubinemia (Phototherapy Initiated)\n\nBILIRUBIN CALCULATIONS / RISK FACTORS:\nAge at sampling: [__ hours] Gestational age: [__ weeks + __ days] Birth weight: [__ g]  \nAAP 2022 Risk Factors: [GA < 38 w / isoimmune hemolysis / G6PD / sepsis / albumin < 3.0 / other]  \nMeasurements: TSB [__ mg/dL] at [__ h] Phototherapy threshold [__ mg/dL] Δ to threshold = [__ mg/dL] (at/above)  \nExchange threshold [__ mg/dL] Rate of rise (if known) [__ mg/dL/hr]\n\n---\n\nInfant presented with progressive jaundice; on exam alert and interactive with normal tone and suck. No signs of acute bilirubin encephalopathy. Serum bilirubin above AAP phototherapy threshold for age and risk factors. No dehydration or clinical signs of infection.\n\nInitiated intensive phototherapy using LED blue lights with maximized body surface exposure and eye protection in place. Encouraged frequent feeds to enhance bilirubin elimination and monitored intake/output. No signs of hemolysis or cephalohematoma requiring additional intervention. Family counseled on treatment course, expected timeline for decline in TSB, and need for serial levels to confirm response.\n\nPatient tolerated therapy well with stable vitals and improving jaundice trend. Plan for TSB recheck in 4–6 hours to confirm decrease, continue phototherapy until TSB is > 2 mg/dL below threshold and trending down. If criteria met, phototherapy to be stopped with rebound TSB draw 6–12 hours later as indicated. Parents informed of follow-up requirements and return precautions.",
    "createdAt": 1761533643278,
    "updatedAt": 1761533696282,
    "pinned": false
  },
  {
    "id": "bili-escalation",
    "title": "BILI — Escalation / Exchange Threshold Consult",
    "category": "Pediatrics",
    "subcategory": "Hyperbili",
    "dot": ".bili3",
    "body": "MDM — Neonatal Hyperbilirubinemia (Escalation / Exchange Threshold)\n\nBILIRUBIN CALCULATIONS / RISK FACTORS:\nAge at sampling: [__ hours] Gestational age: [__ weeks + __ days] Birth weight: [__ g]  \nRisk Factors: [isoimmune hemolysis / G6PD / sepsis / albumin < 3.0 / GA < 38 w / other]  \nMeasurements: TSB [__ mg/dL] at [__ h] Phototherapy threshold [__ mg/dL] Exchange threshold [__ mg/dL]  \nΔ to exchange = [__ mg/dL] (≥ 0 = at/above) Rate of rise [__ mg/dL/hr]\n\n---\n\nInfant with known hyperbilirubinemia on intensive phototherapy demonstrating TSB at or above the AAP exchange threshold. Examination shows alertness with slightly diminished tone but no overt signs of acute bilirubin encephalopathy. Vitals stable, feeding adequate. IV access established and volume status addressed.\n\nGiven TSB [__ mg/dL] at [__ hours] of life and Δ to exchange of [__ mg/dL], consulted Neonatology / NICU for escalation of care and potential exchange transfusion. Additional labs obtained including blood type, DAT/Coombs, CBC/retic, bilirubin fractionation, albumin, and G6PD level. If isoimmune hemolysis present, considered IVIG per AAP protocol. Supportive care continued with maximal phototherapy and temperature monitoring.\n\nDiscussed clinical status and risk of bilirubin neurotoxicity with caregivers; family understood need for NICU-level management and possible exchange procedure. Patient remained hemodynamically stable during transfer preparations.",
    "createdAt": 1761533643279,
    "updatedAt": 1761533681931,
    "pinned": false
  },
  {
    "title": "Untitled macro",
    "category": "Adult",
    "subcategory": "Unsorted",
    "dot": "",
    "body": "",
    "id": "dee9fecc-5141-4b1d-a0de-5ff2b6a6cc3b",
    "createdAt": 3523074849748,
    "updatedAt": 1761545805422,
    "pinned": false
  },
  {
    "title": "Untitled macro",
    "category": "Pediatrics",
    "subcategory": "Unsorted",
    "dot": "",
    "body": "",
    "id": "d5a2a908-9cc9-421a-af7c-8b207fbdd23e",
    "createdAt": 3523074852782,
    "updatedAt": 3523074852782
  },
  {
    "title": "Untitled macro",
    "category": "Pediatrics",
    "subcategory": "Unsorted",
    "dot": "",
    "body": "",
    "id": "490e95dc-3841-4dd7-a948-3954e70a1496",
    "createdAt": 3523091570008,
    "updatedAt": 3523091570008
  }
]</script>

  <!-- Tailwind build CSS (generated by CDN) kept below to avoid altering your existing layout -->

  <style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{inset:0px}.left-1\/2{left:50%}.top-0{top:0px}.top-2\.5{top:0.625rem}.top-4{top:1rem}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.mx-auto{margin-left:auto;margin-right:auto}.my-1{margin-top:0.25rem;margin-bottom:0.25rem}.-mt-0\.5{margin-top:-0.125rem}.mb-3{margin-bottom:0.75rem}.mt-1{margin-top:0.25rem}.mt-10{margin-top:2.5rem}.mt-2{margin-top:0.5rem}.mt-20{margin-top:5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-8{margin-top:2rem}.ml-2{margin-left:0.5rem}.block{display:block}.flex{display:flex}.inline-flex{display:inline-flex}.grid{display:grid}.hidden{display:none}.h-10{height:2.5rem}.h-6{height:1.5rem}.h-full{height:100%}.max-h-\[70vh\]{max-height:70vh}.w-10{width:2.5rem}.w-52{width:13rem}.w-6{width:1.5rem}.w-\[min\(680px\2c 92vw\)\]{width:min(680px,92vw)}.w-\[min\(860px\2c 94vw\)\]{width:min(860px,94vw)}.w-\[min\(900px\2c 94vw\)\]{width:min(900px,94vw)}.w-full{width:100%}.min-w-0{min-width:0px}.max-w-screen-2xl{max-width:1536px}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.cursor-pointer{cursor:pointer}.select-none{-webkit-user-select:none;user-select:none}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-1{gap:0.25rem}.space-y-2 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.5rem * var(--tw-space-y-reverse))}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-1 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.25rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.25rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.break-words{overflow-wrap:break-word}.rounded-2xl{border-radius:1rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-slate-200{--tw-border-opacity:1;border-color:rgb(226 232 240 / var(--tw-border-opacity, 1))}.border-slate-200\/70{border-color:rgb(226 232 240 / 0.7)}.bg-bg1{--tw-bg-opacity:1;background-color:rgb(234 241 251 / var(--tw-bg-opacity, 1))}.bg-bg1\/80{background-color:rgb(234 241 251 / 0.8)}.bg-black\/40{background-color:rgb(0 0 0 / 0.4)}.bg-ink{--tw-bg-opacity:1;background-color:rgb(15 38 64 / var(--tw-bg-opacity, 1))}.bg-primary{--tw-bg-opacity:1;background-color:rgb(30 112 193 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-bg2\/60{background-color:rgb(219 231 246 / 0.6)}.bg-gradient-to-br{background-image:linear-gradient(to bottom right, var(--tw-gradient-stops))}.from-primary{--tw-gradient-from:#1E70C1 var(--tw-gradient-from-position);--tw-gradient-to:rgb(30 112 193 / 0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to)}.to-primary-500{--tw-gradient-to:#3A8BE0 var(--tw-gradient-to-position)}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-5{padding:1.25rem}.p-4{padding:1rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.py-3{padding-top:0.75rem;padding-bottom:0.75rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.pr-12{padding-right:3rem}.pt-2{padding-top:0.5rem}.text-left{text-align:left}.text-center{text-align:center}.font-mono{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-\[13\.5px\]{font-size:13.5px}.text-base{font-size:1rem;line-height:1.5rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-5{line-height:1.25rem}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-0.025em}.tracking-wide{letter-spacing:0.025em}.text-ink{--tw-text-opacity:1;color:rgb(15 38 64 / var(--tw-text-opacity, 1))}.text-muted{--tw-text-opacity:1;color:rgb(91 107 132 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.opacity-60{opacity:0.6}.shadow-soft{--tw-shadow:0 10px 28px rgba(15,38,64,.08);--tw-shadow-colored:0 10px 28px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.hover\:bg-primary\/90:hover{background-color:rgb(30 112 193 / 0.9)}.hover\:bg-slate-50:hover{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style>

  <script>

    /* ================= AUTH LOGIC ================= */

    (function authInit(){

      const form = document.getElementById('loginForm');

      if (!form) return;

      const userEl = document.getElementById('loginUser');

      const passEl = document.getElementById('loginPass');

      const errEl  = document.getElementById('loginError');

      const btn    = document.getElementById('loginBtn');

      function showError(msg){ errEl.textContent = msg || ''; }

      form.addEventListener('submit', function(e){

        e.preventDefault();

        const u = (userEl.value || '').trim();

        const p = (passEl.value || '').trim();

        if (u === 'edtemplates' && p === 'odynophagia') {

          try { localStorage.setItem('rvsred.auth','1'); } catch(e){}

          // Mark as authed and fade app in

          document.documentElement.dataset.authed = '1';

          // Clear error and fields

          showError('');

          passEl.value = '';

        } else {

          showError('Invalid username or password.');

          passEl.focus();

          passEl.select();

        }

      });

      // Convenience: Enter key on either field submits

      [userEl, passEl].forEach(el => el.addEventListener('keydown', (e) => {

        if (e.key === 'Enter') form.requestSubmit();

      }));

    })();

    /* ================= APP CODE (UNCHANGED) ================= */

    const LS_KEY = 'rvsred.macros.v3';

    // Taxonomy

    const TAXONOMY = {

      'Pediatrics':['Viral','Trauma','Hyperbili','Unsorted'],

      'Adult':['Unsorted'],

      'Communication':['Hand-offs','Consults','Unsorted'],

    };

    function loadEmbedded(){ try{ const el=document.getElementById('embedded-data'); return el?JSON.parse(el.textContent||'[]'):[] }catch{ return [] } }

    function load(){

      try{

        const raw = localStorage.getItem(LS_KEY);

        if (raw){ const arr = JSON.parse(raw); return Array.isArray(arr)?arr:[]; }

        const seed = loadEmbedded(); localStorage.setItem(LS_KEY, JSON.stringify(seed)); return seed;

      }catch{ const seed=loadEmbedded(); localStorage.setItem(LS_KEY, JSON.stringify(seed)); return seed; }

    }

    function save(list){ localStorage.setItem(LS_KEY, JSON.stringify(list)); }

    function withMetaSafe(m,i){ const x={...m}; if(!x.id) x.id=crypto.randomUUID(); if(!x.createdAt) x.createdAt=Date.now()+i; if(!x.updatedAt) x.updatedAt=x.createdAt; if(!x.category) x.category='Pediatrics'; return x; }

    // Elements

    const grid=document.getElementById('grid'), emptyState=document.getElementById('empty'), searchEl=document.getElementById('search'),

      toast=document.getElementById('toast'),

      modal=document.getElementById('modal'), modalContent=document.getElementById('modal-content'), modalCancel=document.getElementById('modal-cancel'),

      editModal=document.getElementById('editModal'), editForm=document.getElementById('editForm'), editTitle=document.getElementById('editTitle'),

      editCategory=document.getElementById('editCategory'), editSubcat=document.getElementById('editSubcat'), editDot=document.getElementById('editDot'),

      editPinned=document.getElementById('editPinned'), editBody=document.getElementById('editBody'), editCancel=document.getElementById('editCancel'),

      exportBtn=document.getElementById('exportBtn'), importInput=document.getElementById('importInput'),

      addBtn=document.getElementById('addBtn'), saveSiteBtn=document.getElementById('saveSiteBtn'),

      sideGroups=document.getElementById('side-groups'),

      catalogBtn=document.getElementById('catalogBtn'), catalogModal=document.getElementById('catalogModal'),

      catalogClose=document.getElementById('catalogClose'), catalogContent=document.getElementById('catalog-content'),

      catalogPrint=document.getElementById('catalogPrint'),

      resetSeedBtn=document.getElementById('resetSeedBtn'),

      settingsBtn=document.getElementById('settingsBtn'), settingsMenu=document.getElementById('settingsMenu');

    let data = load().map(withMetaSafe);

    let state = {cat:'All', subcat:null, q:'', editingId:null};

    let lastAutoCopy = ''; // prevent repeat auto-copy spam

    buildSidebar(); render();

    function countByCat(cat){ return data.filter(m=>m.category===cat).length }

    function updateCounts(){ for(const c of Object.keys(TAXONOMY)){ const el=document.getElementById('count-'+c); if(el) el.textContent=countByCat(c) } }

    function sortMacros(a,b){ if(a.pinned&&!b.pinned) return -1; if(!a.pinned&&b.pinned) return 1; return a.createdAt-b.createdAt }

    function filtered(){

      const q=state.q.trim().toLowerCase();

      // If user is typing a dot-phrase, show live matches across ALL categories by dot alias prefix

      if (q.startsWith('.')) {

        const list = data

          .filter(m => (m.dot||'').toLowerCase().startsWith(q))

          .sort(sortMacros);

        return list.length ? list : data.filter(m => (m.dot||'').toLowerCase().includes(q)).sort(sortMacros);

      }

      // Normal filtering

      return data

        .filter(m=>state.cat==='All'?true:m.category===state.cat)

        .filter(m=>state.subcat?((m.subcategory||'Unsorted')===state.subcat):true)

        .filter(m=>!q || (m.title||'').toLowerCase().includes(q) || (m.dot||'').toLowerCase().includes(q) || (m.body||'').toLowerCase().includes(q))

        .sort(sortMacros);

    }

    function render(){

      updateCounts();

      const list=filtered();

      grid.innerHTML='';

      if(!list.length) emptyState.classList.remove('hidden'); else emptyState.classList.add('hidden');

      for(const m of list) grid.appendChild(card(m));

      wireChips();

    }

    // Sidebar

    function buildSidebar(){

      sideGroups.innerHTML = '';

      for (const [cat, subs] of Object.entries(TAXONOMY)) {

        const wrap=document.createElement('div');

        wrap.innerHTML = `

          <div class="px-2 pt-2 text-xs uppercase tracking-wide text-muted">${cat}</div>

          <div class="mt-1 space-y-1" role="list"></div>`;

        const listEl = wrap.querySelector('div[role=list]');

        subs.forEach(sub=>{

          const id = `${cat}::${sub}`;

          const btn=document.createElement('button');

          btn.className="drop-target focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm flex items-center justify-between";

          btn.setAttribute('data-sub', id);

          btn.innerHTML = `<span>${sub}</span><span class="text-xs text-muted ml-2">${data.filter(m=>m.category===cat && (m.subcategory||'Unsorted')===sub).length}</span>`;

          btn.onclick=()=>{ state.cat=cat; state.subcat=sub; render(); };

          // DnD

          btn.addEventListener('dragover',e=>{ e.preventDefault(); btn.classList.add('dragover'); });

          btn.addEventListener('dragleave',()=>btn.classList.remove('dragover'));

          btn.addEventListener('drop',e=>{

            e.preventDefault(); btn.classList.remove('dragover');

            const id=e.dataTransfer.getData('text/plain'); const i=data.findIndex(x=>x.id===id);

            if(i>-1){

              const created=data[i].createdAt;

              data[i]={...data[i], category:cat, subcategory:sub==='Unsorted'?undefined:sub, updatedAt:Date.now(), createdAt:created};

              save(data); buildSidebar(); render(); showToast(`Moved to ${cat} • ${sub}`);

            }

          });

          listEl.appendChild(btn);

        });

        sideGroups.appendChild(wrap);

      }

    }

    function card(m){

      const el=document.createElement('article'); el.className="rounded-2xl bg-white border border-slate-200 shadow-soft p-4";

      el.setAttribute('draggable','true'); el.setAttribute('aria-grabbed','false');

      el.addEventListener('dragstart',e=>{ el.style.opacity='.6'; e.dataTransfer.setData('text/plain', m.id); el.setAttribute('aria-grabbed','true'); });

      el.addEventListener('dragend',()=>{ el.style.opacity='1'; el.setAttribute('aria-grabbed','false'); });

      const sub=m.subcategory?`<span class='inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200'>${escapeHTML(m.subcategory)}</span>`:'';

      el.innerHTML=`

        <div class="flex items-start gap-2">

          <div class="flex-1 min-w-0">

            <h3 class="text-base font-semibold leading-tight break-words">${escapeHTML(m.title||'Untitled')}</h3>

            <div class="mt-1 flex items-center gap-2 text-xs text-muted">

              <span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-bg2/60 border border-slate-200">${escapeHTML(m.category||'')}</span>

              ${sub}

              ${m.dot?`<span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-slate-200">Dot: ${escapeHTML(m.dot)}</span>`:''}

              ${m.pinned?`<span class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full bg-white border border-yellow-300">📌 Pinned</span>`:''}

            </div>

          </div>

          <div class="shrink-0 flex gap-1">

            <button class="focus-ring copy px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Copy</button>

            <button class="focus-ring edit px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Edit</button>

            <button class="focus-ring del  px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-sm">Del</button>

          </div>

        </div>

        <pre class="macro-body mt-3 text-[13.5px] leading-5 border border-slate-200 rounded-xl p-3 overflow-auto">${escapeHTML(m.body||'')}</pre>`;

      el.querySelector('.copy').onclick=()=>copyText(m.body||'');

      el.querySelector('.edit').onclick=()=>openEdit(m.id);

      el.querySelector('.del').onclick=()=>confirmDelete(m.id);

      return el;

    }

    function wireChips(){

      document.querySelectorAll('.chip').forEach(btn=>{

        btn.onclick = () => {

          const [cat, sub] = btn.getAttribute('data-sub').split('::');

          state.cat = cat;

          state.subcat = sub;

          render();

        };

      });

    }

    // Dot-phrase helpers

    function handleDotPhraseEnter(raw){

      const q=raw.trim(); if(!q.startsWith('.')) return false;

      const exact=data.filter(m=>(m.dot||'').toLowerCase()===q.toLowerCase());

      if(exact.length===1){ copyText(exact[0].body||'',`Copied ${exact[0].dot}`); return true; }

      const starts=data.filter(m=>(m.dot||'').toLowerCase().startsWith(q.toLowerCase()));

      const pool=starts.length?starts:data.filter(m=>(m.dot||'').toLowerCase().includes(q.toLowerCase()));

      if(!pool.length){ showToast('No matching dot-phrase'); return true; }

      if(pool.length===1){ copyText(pool[0].body||'',`Copied ${pool[0].dot}`); return true; }

      openChooser(pool,`Multiple matches for “${q}”`); return true;

    }

    function maybeAutoCopyLive(q){

      if(!q.startsWith('.')) return;

      const exact = data.find(m => (m.dot||'').toLowerCase() === q.toLowerCase());

      if (exact && lastAutoCopy !== q.toLowerCase()) {

        lastAutoCopy = q.toLowerCase();

        copyText(exact.body||'', `Copied ${exact.dot}`);

      }

      if (!exact && lastAutoCopy && !q.toLowerCase().startsWith(lastAutoCopy)) {

        lastAutoCopy = '';

      }

    }

    function openChooser(list,title){

      document.getElementById('modal-title').textContent=title||'Choose a macro';

      const mc=document.getElementById('modal-content'); mc.innerHTML='';

      for(const m of list.sort(sortMacros)){

        const b=document.createElement('button'); b.className="focus-ring w-full text-left px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50";

        b.innerHTML=`<div class="text-sm font-medium">${escapeHTML(m.title||'')}</div><div class="text-xs text-muted">${escapeHTML(m.dot||'')} • ${escapeHTML(m.category||'')}${m.subcategory?' • '+escapeHTML(m.subcategory):''}</div>`;

        b.onclick=()=>{ closeModal(); copyText(m.body||'',`Copied ${m.dot||'macro'}`); };

        mc.appendChild(b);

      }

      openModal();

    }

    async function copyText(text,msg='Copied to clipboard'){

      try{ await navigator.clipboard.writeText(text) }

      catch{

        const ta=document.createElement('textarea'); ta.value=text||''; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); document.body.removeChild(ta);

      }

      showToast(msg);

    }

    let toastTimer=null;

    function showToast(message){

      const t=toast; t.textContent=message; t.style.display='block';

      requestAnimationFrame(()=>t.classList.add('show'));

      clearTimeout(toastTimer);

      toastTimer=setTimeout(()=>{ t.classList.remove('show'); setTimeout(()=>t.style.display='none',200); },1400);

    }

    function openModal(){ modal.classList.remove('hidden') } function closeModal(){ modal.classList.add('hidden') }

    document.getElementById('modal-cancel').onclick=closeModal; modal.addEventListener('click',e=>{ if(e.target===modal) closeModal() });

    function openEdit(id){

      const m=data.find(x=>x.id===id); if(!m) return; state.editingId=id;

      editTitle.value=m.title||''; editCategory.value=m.category||'Pediatrics'; editSubcat.value=m.subcategory||''; editDot.value=m.dot||''; editPinned.value=m.pinned?'true':'false'; editBody.value=m.body||'';

      editModal.classList.remove('hidden'); setTimeout(()=>editTitle.focus(),0);

    }

    function closeEdit(){ state.editingId=null; editModal.classList.add('hidden') }

    document.getElementById('editCancel').onclick=closeEdit; editModal.addEventListener('click',e=>{ if(e.target===editModal) closeEdit() });

    editForm.onsubmit=e=>{

      e.preventDefault(); const i=data.findIndex(x=>x.id===state.editingId); if(i===-1) return; const created=data[i].createdAt;

      data[i]={...data[i], title:editTitle.value, category:editCategory.value, subcategory:editSubcat.value||undefined, dot:editDot.value.trim(), pinned:editPinned.value==='true', body:editBody.value, updatedAt:Date.now(), createdAt:created};

      save(data); buildSidebar(); closeEdit(); render(); showToast('Saved');

    };

    function confirmDelete(id){ if(!confirm('Delete this macro?')) return; data=data.filter(m=>m.id!==id); save(data); buildSidebar(); render(); showToast('Deleted'); }

    // Search events

    searchEl.addEventListener('input',e=>{

      state.q = e.target.value;

      // If typing a dot phrase, force All so other filters don't block results

      if (state.q.trim().startsWith('.')) {

        state.cat = 'All';

        state.subcat = null;

        maybeAutoCopyLive(state.q.trim().toLowerCase());

      }

      render();

    });

    // Enter-to-copy

    searchEl.addEventListener('keydown',e=>{

      if(e.key==='Enter'){

        const raw=searchEl.value;

        if(raw.trim().startsWith('.')){ e.preventDefault(); handleDotPhraseEnter(raw); }

      }

    });

    // Export / Import / Save Site / Reset (inside Settings menu)

    exportBtn.onclick=()=>{ const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; const stamp=new Date().toISOString().slice(0,19).replace(/[:T]/g,'-'); a.download=`rvsred-macros-${stamp}.json`; a.click(); URL.revokeObjectURL(url); showToast('Exported JSON'); };

    importInput.onchange=async e=>{

      const f=e.target.files?.[0]; if(!f) return;

      try{

        const txt=await f.text(); const incoming=JSON.parse(txt);

        if(!Array.isArray(incoming)) throw new Error('Invalid file');

        const map=new Map(data.map(m=>[m.id,m]));

        for(const m of incoming){ const safe=withMetaSafe(m,0); map.set(safe.id,{...map.get(safe.id),...safe,createdAt:(map.get(safe.id)?.createdAt??safe.createdAt)}); }

        data=[...map.values()]; save(data); buildSidebar(); render(); showToast('Imported');

      }catch(err){ alert('Import failed: '+err.message); }

      finally{ importInput.value=''; }

    };

    saveSiteBtn.onclick=()=>{ try{

      const clone=document.documentElement.cloneNode(true);

      const script=clone.querySelector('#embedded-data'); if(script){ script.textContent=JSON.stringify(data,null,2); }

      clone.querySelectorAll('#toast,.toast-pop').forEach(el=>{ el.style.display='none'; el.classList.remove('show'); });

      const html='<!DOCTYPE html>\n'+clone.outerHTML;

      const blob=new Blob([html],{type:'text/html'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='index.html'; a.click(); URL.revokeObjectURL(url); showToast('Site saved (index.html downloaded)'); if(getSyncOnSave()){ (async()=>{ try{ await syncToRepo(html); showToast('Synced to GitHub'); }catch(e){ alert(e.message); } })(); }

    }catch(err){ alert('Save Site failed: '+err.message); } };
    // ---------- GitHub Repo Sync ----------
    const repoCfgKey = 'repoCfg';
    const syncOnSaveKey = 'syncOnSave';

    const getRepoCfg = ()=> {
      try { return JSON.parse(localStorage.getItem(repoCfgKey) || '{}'); }
      catch { return {}; }
    };
    const setRepoCfg = (cfg)=> localStorage.setItem(repoCfgKey, JSON.stringify(cfg));
    const getSyncOnSave = ()=> localStorage.getItem(syncOnSaveKey) === '1';
    const setSyncOnSave = (v)=> localStorage.setItem(syncOnSaveKey, v ? '1' : '0');

    // UTF-8 safe base64
    const toBase64 = (str) => btoa(unescape(encodeURIComponent(str)));

    // Create a fresh HTML snapshot identical to the "Save Site" output
    const generateCurrentHTML = () => {
      const clone=document.documentElement.cloneNode(true);
      const script=clone.querySelector('#embedded-data'); if(script){ script.textContent=JSON.stringify(data,null,2); }
      clone.querySelectorAll('#toast,.toast-pop').forEach(el=>{ el.style.display='none'; el.classList.remove('show'); });
      return '<!DOCTYPE html>\n'+clone.outerHTML;
    };

    async function githubGetSha({owner,repo,branch,path,token}){
      const url = `https://api.github.com/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(branch)}`;
      const res = await fetch(url, { headers: { 'Authorization': 'Bearer '+token, 'Accept':'application/vnd.github+json' } });
      if(res.status === 404) return null;
      if(!res.ok){ throw new Error('GitHub GET failed: '+res.status); }
      const j = await res.json();
      return j.sha || null;
    }

    async function syncToRepo(htmlString){
      const cfg = getRepoCfg();
      const owner = (cfg.owner||'').trim();
      const repo  = (cfg.repo||'').trim();
      const branch= (cfg.branch||'main').trim();
      const dir   = (cfg.dir||'').trim().replace(/^\/+|\/+$/g,''); // trim slashes
      const token = (cfg.token||'').trim();

      if(!owner || !repo || !token){ alert('Repository Settings incomplete. Please fill Owner, Repository, and Token.'); return; }

      const path = (dir ? (dir + '/index.html') : 'index.html');

      let sha = null;
      try { sha = await githubGetSha({owner,repo,branch,path,token}); } catch(e){ /* ignore 404 or errors here; will try create */ }

      const url = `https://api.github.com/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}`;
      const body = {
        message: 'Update index.html via RVSRED',
        content: toBase64(htmlString),
        branch,
        ...(sha ? { sha } : {})
      };
      const res = await fetch(url, {
        method:'PUT',
        headers: {
          'Authorization': 'Bearer '+token,
          'Accept': 'application/vnd.github+json',
          'Content-Type':'application/json'
        },
        body: JSON.stringify(body)
      });
      if(!res.ok){
        const msg = await res.text();
        throw new Error('GitHub PUT failed: '+res.status+' '+msg);
      }
    }

    // Wire up UI
    const syncToggle = document.getElementById('syncOnSaveToggle');
    if(syncToggle){ syncToggle.checked = getSyncOnSave(); syncToggle.onchange = ()=> setSyncOnSave(syncToggle.checked); }

    const repoSettingsBtn = document.getElementById('repoSettingsBtn');
    const repoModal = document.getElementById('repoModal');
    const repoForm = document.getElementById('repoForm');
    const repoCancel = document.getElementById('repoCancel');

    const openRepoModal = ()=> {
      const cfg = getRepoCfg();
      document.getElementById('ghOwner').value = cfg.owner||'';
      document.getElementById('ghRepo').value = cfg.repo||'';
      document.getElementById('ghBranch').value = cfg.branch||'main';
      document.getElementById('ghDir').value = cfg.dir||'';
      document.getElementById('ghToken').value = cfg.token||'';
      repoModal.classList.remove('hidden');
    };
    const closeRepoModal = ()=> repoModal.classList.add('hidden');

    if(repoSettingsBtn){ repoSettingsBtn.onclick = openRepoModal; }
    if(repoCancel){ repoCancel.onclick = closeRepoModal; }
    if(repoForm){
      repoForm.onsubmit = (e)=>{
        e.preventDefault();
        const cfg = {
          owner: document.getElementById('ghOwner').value.trim(),
          repo: document.getElementById('ghRepo').value.trim(),
          branch: document.getElementById('ghBranch').value.trim() || 'main',
          dir: document.getElementById('ghDir').value.trim(),
          token: document.getElementById('ghToken').value
        };
        setRepoCfg(cfg);
        closeRepoModal();
        showToast('Repository settings saved');
      };
    }

    const syncNowBtn = document.getElementById('syncNowBtn');
    if(syncNowBtn){
      syncNowBtn.onclick = async ()=>{
        try{
          const html = generateCurrentHTML();
          await syncToRepo(html);
          showToast('Synced to GitHub');
        }catch(err){ alert(err.message); }
      };
    }


    document.getElementById('catalogPrint').onclick=()=>{ const win=window.open('','_blank'); if(!win) return; win.document.write('<!doctype html><title>RVSRED Catalog</title><meta charset="utf-8"><style>body{font:14px system-ui,Arial,sans-serif;padding:24px;line-height:1.45} h2{margin-top:24px} h3{margin:16px 0 8px} .sub{color:#555} li{margin:4px 0}</style>'+catalogContent.innerHTML); win.document.close(); win.focus(); win.print(); };

    const openCatalog = ()=> {

      const byCat = {};

      for(const m of data){ const cat=m.category||'Uncategorized'; const sub=(m.subcategory||'Unsorted'); byCat[cat]=byCat[cat]||{}; byCat[cat][sub]=byCat[cat][sub]||[]; byCat[cat][sub].push(m); }

      const frag=document.createDocumentFragment();

      for(const cat of Object.keys(byCat).sort()){

        const catEl=document.createElement('section');

        catEl.innerHTML=`<h2>${cat}</h2>`;

        const subs=byCat[cat];

        for(const sub of Object.keys(subs).sort()){

          const list=subs[sub].sort(sortMacros);

          const wrap=document.createElement('div');

          wrap.innerHTML=`<h3 class="sub">${sub}</h3>`;

          const ul=document.createElement('ul'); ul.className='list-disc pl-5';

          for(const m of list){

            const li=document.createElement('li');

            li.innerHTML=`<strong>${escapeHTML(m.title||'Untitled')}</strong>${m.dot?` — <code>${escapeHTML(m.dot)}</code>`:''}`;

            ul.appendChild(li);

          }

          wrap.appendChild(ul); catEl.appendChild(wrap);

        }

        frag.appendChild(catEl);

      }

      catalogContent.innerHTML=''; catalogContent.appendChild(frag);

      catalogModal.classList.remove('hidden');

    };

    document.getElementById('catalogClose').onclick=()=>catalogModal.classList.add('hidden');

    catalogBtn.onclick=openCatalog;

    catalogModal.addEventListener('click',e=>{ if(e.target===catalogModal) catalogModal.classList.add('hidden'); });

    resetSeedBtn.onclick=()=>{ try{

      localStorage.removeItem(LS_KEY);

      const seed=loadEmbedded(); data=seed.map(withMetaSafe); save(data); buildSidebar(); render(); showToast('Re-seeded from file');

    }catch(err){ alert('Reset failed: '+err.message); } };

    // Settings menu behavior

    function closeSettings(){ settingsMenu.classList.remove('open'); settingsBtn.setAttribute('aria-expanded','false'); }

    function openSettings(){ settingsMenu.classList.add('open'); settingsBtn.setAttribute('aria-expanded','true'); }

    settingsBtn.addEventListener('click',()=>{

      const open = settingsMenu.classList.contains('open');

      open ? closeSettings() : openSettings();

    });

    document.addEventListener('click',e=>{

      if(!settingsMenu.contains(e.target) && e.target!==settingsBtn){ closeSettings(); }

    });

    document.addEventListener('keydown',e=>{ if(e.key==='Escape') closeSettings(); });

    // New macro

    addBtn.onclick=()=>{

      const now=Date.now();

      data.push(withMetaSafe({

        title:'Untitled macro',

        category:'Pediatrics',

        subcategory:'Unsorted',

        dot:'',

        body:''

      }, now));

      save(data); buildSidebar(); render(); showToast('New macro added');

    };

    function escapeHTML(s=''){ return s.replace(/[&<>"']/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

    // Initial renders that depend on DOM:

    buildSidebar();

    render();

  </script>




  <!-- Repo Settings Modal -->
  <div id="repoModal" class="fixed inset-0 z-40 hidden" role="dialog" aria-modal="true" aria-labelledby="repoTitle">
    <div class="absolute inset-0 bg-black/30"></div>
    <div class="relative mx-auto mt-24 w-[min(720px,calc(100vw-2rem))] rounded-2xl bg-white p-5 shadow-soft">
      <h2 id="repoTitle" class="text-lg font-semibold text-slate-800">Repository Settings</h2>
      <p class="text-sm text-muted mt-1">Used for syncing index.html to GitHub. Values are stored locally in this browser.</p>
      <form id="repoForm" class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3">
        <label class="text-sm">Owner (user or org)
          <input id="ghOwner" type="text" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="e.g., your-username">
        </label>
        <label class="text-sm">Repository
          <input id="ghRepo" type="text" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="e.g., rvsred-templates">
        </label>
        <label class="text-sm">Branch
          <input id="ghBranch" type="text" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2" value="main">
        </label>
        <label class="text-sm">Directory (optional)
          <input id="ghDir" type="text" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="e.g., / (root) or docs">
        </label>
        <label class="text-sm md:col-span-2">Personal Access Token (classic, repo scope)
          <input id="ghToken" type="password" class="mt-1 w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="ghp_…">
        </label>
        <div class="md:col-span-2 flex justify-end gap-2 pt-2"><button type="button" id="repoValidateBtn" title="Check token, repo, and branch before syncing" style="margin-right: auto; padding: 0.5rem 0.75rem; border-radius: 0.5rem; border: 1px solid rgb(207, 214, 228); background: rgb(243, 246, 251); cursor: pointer;">Validate Access</button><button type="button" id="repoValidateBtn" title="Check token, repo, and branch before syncing" style="margin-right: auto; padding: 0.5rem 0.75rem; border-radius: 0.5rem; border: 1px solid rgb(207, 214, 228); background: rgb(243, 246, 251); cursor: pointer;">Validate Access</button><button type="button" id="repoValidateBtn" title="Check token, repo, and branch before syncing" style="margin-right: auto; padding: 0.5rem 0.75rem; border-radius: 0.5rem; border: 1px solid rgb(207, 214, 228); background: rgb(243, 246, 251); cursor: pointer;">Validate Access</button>
          <button type="button" id="repoCancel" class="focus-ring px-3 py-2 rounded-xl border border-slate-200">Cancel</button>
          <button type="submit" class="focus-ring px-4 py-2 rounded-xl bg-primary text-white hover:bg-primary/90">Save</button>
        </div>
      </form>
    </div>
  </div>


<!-- Lazy bind for Repo Settings (ensures modal opens even if earlier references were null) -->
<script>
(function () {
  // Wait a microtask to ensure elements exist
  const repoSettingsBtn = document.getElementById('repoSettingsBtn');
  const repoModal = document.getElementById('repoModal');
  const repoForm = document.getElementById('repoForm');
  const repoCancel = document.getElementById('repoCancel');
  if (!repoSettingsBtn || !repoModal) return;

  function openRepoModal() {
    try {
      const cfg = (typeof getRepoCfg === 'function') ? getRepoCfg() : {};
      document.getElementById('ghOwner').value = cfg.owner || '';
      document.getElementById('ghRepo').value = cfg.repo || '';
      document.getElementById('ghBranch').value = cfg.branch || 'main';
      document.getElementById('ghDir').value = cfg.dir || '';
      document.getElementById('ghToken').value = cfg.token || '';
    } catch (e) {}
    repoModal.classList.remove('hidden');
  }
  function closeRepoModal(){ repoModal.classList.add('hidden'); }

  // Button opens modal
  repoSettingsBtn.addEventListener('click', function (e) {
    e.preventDefault();
    openRepoModal();
  });

  // Cancel closes modal
  if (repoCancel) {
    repoCancel.addEventListener('click', function () { closeRepoModal(); });
  }

  // Submit saves config then closes
  if (repoForm) {
    repoForm.addEventListener('submit', function (e) {
      e.preventDefault();
      if (typeof setRepoCfg === 'function') {
        const cfg = {
          owner: (document.getElementById('ghOwner').value || '').trim(),
          repo:  (document.getElementById('ghRepo').value  || '').trim(),
          branch:(document.getElementById('ghBranch').value|| 'main').trim(),
          dir:   (document.getElementById('ghDir').value   || '').trim(),
          token:  document.getElementById('ghToken').value || ''
        };
        setRepoCfg(cfg);
      }
      closeRepoModal();
      if (typeof showToast === 'function') showToast('Repository settings saved');
    });
  }
})();
</script>


<script>
// ---- Repo Access Validator (non-destructive) ----
(function(){
  const modal = document.getElementById('repoModal');
  const form  = document.getElementById('repoForm');
  if(!modal || !form) return;

  // Build / insert a tiny Validate button into the modal footer area
  const footer = modal.querySelector('[data-repo-modal-footer]') || modal.querySelector('.repo-modal-footer') || modal.querySelector('footer, .flex.items-center.justify-end, .flex.justify-end');
  const btn = document.createElement('button');
  btn.type = 'button';
  btn.id = 'repoValidateBtn';
  btn.textContent = 'Validate Access';
  btn.style.marginRight = 'auto';
  btn.style.padding = '0.5rem 0.75rem';
  btn.style.borderRadius = '0.5rem';
  btn.style.border = '1px solid #cfd6e4';
  btn.style.background = '#f3f6fb';
  btn.style.cursor = 'pointer';
  btn.title = 'Check token, repo, and branch before syncing';

  const targetFooter = footer || modal.querySelector('form') || modal;
  targetFooter.insertBefore(btn, targetFooter.firstChild);

  async function apiGET(url, token){
    const res = await fetch(url, {
      method: 'GET',
      headers: {
        'Accept': 'application/vnd.github+json',
        'Authorization': token ? `Bearer ${token}` : undefined,
        'X-GitHub-Api-Version': '2022-11-28'
      }
    });
    const body = await res.json().catch(()=>({}));
    return {status: res.status, ok: res.ok, body};
  }

  function getCfg(){
    return {
      owner: (document.getElementById('ghOwner')?.value || '').trim(),
      repo:  (document.getElementById('ghRepo')?.value  || '').trim(),
      branch:(document.getElementById('ghBranch')?.value|| 'main').trim(),
      token:  document.getElementById('ghToken')?.value || ''
    };
  }

  btn.addEventListener('click', async ()=>{
    const {owner, repo, branch, token} = getCfg();
    if(!owner || !repo){
      alert('Enter Owner and Repo first.');
      return;
    }
    const base = `https://api.github.com/repos/${encodeURIComponent(owner)}/${encodeURIComponent(repo)}`;

    try {
      // 1) Repo visibility & permission check
      const r1 = await apiGET(base, token);
      if(!r1.ok){
        if(r1.status === 401){
          alert('401 Unauthorized: Token missing or invalid. Recreate or re-paste your token.');
          return;
        }
        if(r1.status === 403){
          alert('403: Token cannot access this repo.\n• If using a Fine-grained token: select THIS repo and grant "Repository permissions → Contents: Read and Write".\n• If using a Classic token: include the "repo" scope.\n• If the repo is under an organization with SSO: authorize the token for that org.');
          return;
        }
        if(r1.status === 404){
          alert('404: Repo not found. Check Owner/Repo spelling.');
          return;
        }
      }

      // 2) Branch check
      const r2 = await apiGET(`${base}/branches/${encodeURIComponent(branch)}`, token);
      if(!r2.ok){
        if(r2.status === 404){
          alert(`Branch "${branch}" not found. Open GitHub → Branches and confirm the name, or set Branch to the repo's default.`);
          return;
        }
      }

      // If we got here, both checks passed
      alert('✅ Token can access the repo and the branch exists. You should be able to Sync now.');
    } catch(err){
      alert('Validation error: ' + (err?.message || err));
    }
  });
})();
</script>


<script>
// -------- Robust GitHub Sync with auto-SHA resolution --------
(function(){
  if (window.__autoshan_patch_applied__) return;
  window.__autoshan_patch_applied__ = true;

  async function ghGet(url, token){
    const r = await fetch(url, {
      headers: {
        'Accept': 'application/vnd.github+json',
        'Authorization': token ? `Bearer ${token}` : undefined,
        'X-GitHub-Api-Version': '2022-11-28'
      }
    });
    const body = await r.json().catch(()=>({}));
    return {status: r.status, ok: r.ok, body};
  }
  async function ghPut(url, token, payload){
    const r = await fetch(url, {
      method: 'PUT',
      headers: {
        'Accept': 'application/vnd.github+json',
        'Authorization': token ? `Bearer ${token}` : undefined,
        'X-GitHub-Api-Version': '2022-11-28',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(payload)
    });
    const body = await r.json().catch(()=>({}));
    return {status: r.status, ok: r.ok, body};
  }

  // Expose a robust sync method (used by "Sync to Repo Now" and "Sync on Save")
  window.githubSyncAutoSha = async function({owner, repo, branch, dir, token, filename='index.html', content, message='Sync from app'}){
    const base = `https://api.github.com/repos/${encodeURIComponent(owner)}/${encodeURIComponent(repo)}/contents`;
    const path = (dir && dir !== '/' ? `${dir.replace(/^\/+|\/+$/g,'')}/` : '') + filename;
    const getUrl = `${base}/${encodeURIComponent(path)}?ref=${encodeURIComponent(branch)}`;
    const putUrl = `${base}/${encodeURIComponent(path)}`;

    // Step 1: check if file exists to get current sha
    let sha = null;
    let g = await ghGet(getUrl, token);
    if (g.ok && g.body && g.body.sha) {
      sha = g.body.sha;
    }

    // Step 2: attempt PUT with or without sha accordingly
    const payload = {
      message,
      content: btoa(unescape(encodeURIComponent(content))), // UTF-8 safe
      branch
    };
    if (sha) payload.sha = sha;

    let p = await ghPut(putUrl, token, payload);

    // Step 3: If 409 due to sha mismatch, refresh sha and retry once
    if (p.status === 409) {
      const g2 = await ghGet(getUrl, token);
      if (g2.ok && g2.body && g2.body.sha && g2.body.sha !== sha) {
        payload.sha = g2.body.sha;
        p = await ghPut(putUrl, token, payload);
      }
    }

    if (!p.ok) {
      const msg = (p.body && (p.body.message || JSON.stringify(p.body))) || `status ${p.status}`;
      throw new Error(`GitHub PUT failed: ${p.status} — ${msg}`);
    }
    return p.body;
  };

  // Patch any existing sync button handler to use our robust method if available
  document.addEventListener('click', function(e){
    const el = e.target.closest('#syncToRepoNowBtn, [data-sync-now]');
    if (!el) return;
    if (typeof getRepoCfg !== 'function' || typeof buildHtmlSnapshot !== 'function') return;
    e.stopPropagation();
    e.preventDefault();
    const cfg = getRepoCfg();
    const html = await (window.getSnapshotSafe ? window.getSnapshotSafe() : buildHtmlSnapshot());
    (async ()=>{
      try{
        await window.githubSyncAutoSha({
          owner: cfg.owner, repo: cfg.repo, branch: cfg.branch, dir: cfg.dir || '',
          token: cfg.token, filename: 'index.html', content: html, message: 'Sync from app'
        });
        if (typeof showToast === 'function') showToast('✅ Synced to GitHub');
        else alert('✅ Synced to GitHub');
      }catch(err){
        alert(err.message || err);
      }
    })();
  }, true);
})();
</script>


<script>
// ---- RVSRED State export/import + GitHub backup ----
(function(){
  function dumpLocalStorage() {
    const out = {};
    for (let i = 0; i < localStorage.length; i++) {
      const k = localStorage.key(i);
      out[k] = localStorage.getItem(k);
    }
    return out;
  }
  function sanitizedState(){
    const all = dumpLocalStorage();
    delete all['repoCfg'];
    delete all['syncOnSave'];
    delete all['__lastStateTs'];
    return {
      meta: {
        app: 'RVSRED',
        version: (window.APP_VERSION || '1.0.0'),
        savedAt: new Date().toISOString()
      },
      storage: all
    };
  }
  window.embedRvsredState = function(html){
    try{
      const state = sanitizedState();
      const json = JSON.stringify(state);
      const tag  = `<script id="rvsred-state" type="application/json">${json.replace(/</g,"\\u003c")}</script>`;
      if (html.includes('id="rvsred-state"')) {
        html = html.replace(/<script id="rvsred-state" [^="">]*>.*?<\/script>/s, tag);
      } else {
        html = html.replace('</head>', tag + '\\n</head>');
      }
      return html;
    }catch(e){
      return html;
    }
  };
  window.hydrateFromEmbeddedState = function(force=false){
    try{
      const el = document.getElementById('rvsred-state');
      if (!el) return false;
      const parsed = JSON.parse(el.textContent || '{}');
      const tsNew = parsed?.meta?.savedAt ? Date.parse(parsed.meta.savedAt) : 0;
      const tsExisting = Date.parse(localStorage.getItem('__lastStateTs') || 0);
      if (force || !localStorage.length || tsNew > tsExisting){
        const map = parsed.storage || {};
        Object.keys(map).forEach(k => {
          if (k === 'repoCfg' || k === 'syncOnSave') return;
          localStorage.setItem(k, map[k]);
        });
        localStorage.setItem('__lastStateTs', parsed?.meta?.savedAt || new Date().toISOString());
        return true;
      }
      return false;
    }catch(e){
      return false;
    }
  };
  document.addEventListener('DOMContentLoaded', function(){
    try{ window.hydrateFromEmbeddedState(false); }catch(e){}
  });
  if (typeof window.buildHtmlSnapshot === 'function') {
    const _orig = window.buildHtmlSnapshot;
    window.buildHtmlSnapshot = function(){
      const raw = _orig();
      return window.embedRvsredState(raw);
    };
  }
  if (typeof window.githubSyncAutoSha === 'function') {
    const _sync = window.githubSyncAutoSha;
    window.githubSyncAutoSha = async function(opts){
      const res = await _sync(opts);
      try {
        const state = sanitizedState();
        const content = JSON.stringify(state, null, 2);
        const dir = (opts.dir && opts.dir !== '/' ? String(opts.dir).replace(/^\/+|\/+$/g,'') + '/data' : 'data');
        await _sync({
          ...opts,
          filename: 'app-state.json',
          dir,
          content,
          message: 'Backup RVSRED state'
        });
      } catch(e){ /* non-fatal */ }
      return res;
    }
  }
})();
</script>



<script>
(function(){
  // Safe snapshot helper used by all sync paths (never throws)
  window.getSnapshotSafe = async function(){
    try {
      if (typeof buildHtmlSnapshot === 'function') {
        return buildHtmlSnapshot();
      }
    } catch(e) {}
    try {
      if (typeof exportHtmlSnapshot === 'function') {
        return exportHtmlSnapshot();
      }
    } catch(e) {}
    // Last resort: serialize current DOM
    try {
      var doc = document;
      var doctype = "<!doctype html>";
      if (doc.doctype) {
        var name = doc.doctype.name || "html";
        var pub  = doc.doctype.publicId ? ' PUBLIC "' + doc.doctype.publicId + '"' : '';
        var sys  = doc.doctype.systemId ? (doc.doctype.publicId ? ' "' + doc.doctype.systemId + '"' : ' SYSTEM "' + doc.doctype.systemId + '"') : '';
        doctype = "<!DOCTYPE " + name + pub + sys + ">";
      }
      var html = doctype + "
" + (doc.documentElement ? doc.documentElement.outerHTML : "<html></html>");
      if (typeof embedRvsredState === 'function') {
        try { html = embedRvsredState(html); } catch(e) {}
      }
      return html;
    } catch(e) {
      // Absolute fallback
      try {
        return "<!doctype html>
" + document.documentElement.outerHTML;
      } catch(e2) {
        return "<!doctype html><html><head><meta charset='utf-8'></head><body>Snapshot Fallback<!-- ===== EM Templates: Gear Settings + Blue Theme Fix Pack (non-destructive) ===== -->
<style>
  :root{
    --em-blue:#1E70C1;
    --em-blue-700:#175da3;
    --em-bg:#eef6ff;
    --em-card:#ffffff;
    --em-card-border:rgba(30,112,193,.12);
  }
  body{background:var(--em-bg);}
  .card{background:var(--em-card);border:1px solid var(--em-card-border);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.06);}
  .btn-brand{background:var(--em-blue);color:#fff;border:1px solid var(--em-blue);}
  .btn-brand:hover{background:var(--em-blue-700);border-color:var(--em-blue-700);}
  .macro, pre{background:#f1f7ff !important}
  #settingsBtn,.settings-pill,[data-legacy-settings]{display:none!important}
  #em-gear{
    position:fixed;top:14px;right:14px;z-index:2147483600;
    width:42px;height:42px;border-radius:999px;border:1px solid rgba(255,255,255,.45);
    background:linear-gradient(180deg,#2f79ff,#1e60f5); color:#fff; cursor:pointer;
    display:inline-flex;align-items:center;justify-content:center; box-shadow:0 10px 24px rgba(0,0,0,.18);
  }
  #em-gear:before{content:"⚙";font-size:18px;line-height:1}
  #em-panel{
    position:fixed;top:62px;right:14px;z-index:2147483601; display:none;
    width:min(92vw,360px);max-height:78vh;overflow:auto;
    background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:12px;box-shadow:0 16px 44px rgba(0,0,0,.22);
    padding:12px;
  }
  #em-panel.open{display:block}
  #em-panel .x{position:sticky;top:0;float:right;width:28px;height:28px;border-radius:999px;border:1px solid #e5e7eb;background:#f6f6f6;cursor:pointer}
  #em-panel .row{display:flex;gap:.5rem;flex-wrap:wrap;align-items:center;margin:.5rem 0}
  #em-panel .field{display:block;margin:.4rem 0 .2rem;font-size:.9rem;color:#334155}
  #em-panel .input{width:100%;box-sizing:border-box;border:1px solid #e2e8f0;border-radius:8px;padding:.5rem .6rem;font-size:.95rem}
  #em-panel .btn{padding:.5rem .75rem;border-radius:10px;border:1px solid #e5e7eb;background:#fff;cursor:pointer}
  #em-panel .btn.primary{background:var(--em-blue);color:#fff;border-color:var(--em-blue)}
  #em-panel .btn.primary:hover{background:var(--em-blue-700);border-color:var(--em-blue-700)}
  #em-status{font-size:.85rem;color:#475569;min-height:1em;margin-top:.25rem}
</style>

<button id="em-gear" type="button" aria-label="Open Settings"></button>

<div id="em-panel" role="dialog" aria-modal="true" aria-label="Settings">
  <button class="x" type="button" aria-label="Close">✕</button>

  <div class="space-y-2">
    <button class="btn w-full text-left" data-cmd="export">Export JSON</button>
    <button class="btn w-full text-left" data-cmd="import">Import JSON</button>
    <button class="btn w-full text-left" data-cmd="saveSite">Save Site</button>
    <button class="btn w-full text-left" data-cmd="reset">Reset Data</button>
  </div>

  <details class="mt-3">
    <summary class="font-semibold cursor-pointer py-2">Repository Settings…</summary>
    <div class="mt-2">
      <label class="field">Owner
        <input id="ghOwner" class="input" value="raquelvsuarezucf-dot">
      </label>
      <label class="field">Repo
        <input id="ghRepo" class="input" value="ED-templates-RS">
      </label>
      <label class="field">Branch
        <input id="ghBranch" class="input" value="main">
      </label>
      <label class="field">Path (e.g., index.html)
        <input id="ghPath" class="input" value="index.html">
      </label>
      <label class="field">Personal Access Token
        <input id="ghToken" type="password" class="input" placeholder="ghp_…">
      </label>
      <label class="row"><input id="ghAutoSync" type="checkbox"> Auto-sync after Save</label>

      <div class="row">
        <button id="em-save-repo" class="btn">Save Repo Settings</button>
        <button id="em-sync" class="btn primary">Sync to Repo Now</button>
        <button id="em-sync-sha" class="btn">Force Sync (Auto-SHA)</button>
      </div>
      <div id="em-status"></div>
    </div>
  </details>
</div>

<script>
(function(){
  const gear  = document.getElementById('em-gear');
  const panel = document.getElementById('em-panel');
  const close = panel.querySelector('.x');
  const shut  = ()=>panel.classList.remove('open');
  gear.addEventListener('click', (e)=>{ e.stopPropagation(); panel.classList.toggle('open'); });
  close.addEventListener('click', (e)=>{ e.stopPropagation(); shut(); });
  document.addEventListener('click', (e)=>{ if(!panel.contains(e.target) && e.target!==gear) shut(); });

  // Local ops
  const status = (t)=>{ const el=document.getElementById('em-status'); if(el) el.textContent=t||''; };
  panel.addEventListener('click', async (e)=>{
    const b=e.target.closest('[data-cmd]'); if(!b) return;
    const cmd=b.dataset.cmd;
    if(cmd==='export'){
      try{
        const raw=localStorage.getItem('emtemplates.data')||'{}';
        const blob=new Blob([raw],{type:'application/json'});
        const url=URL.createObjectURL(blob);
        const a=document.createElement('a'); a.href=url; a.download='emtemplates.json'; a.click(); URL.revokeObjectURL(url);
      }catch(_){ alert('Export failed'); }
    }
    if(cmd==='import'){
      const inp=document.createElement('input'); inp.type='file'; inp.accept='application/json';
      inp.onchange=async()=>{ const f=inp.files[0]; if(!f) return; const t=await f.text();
        try{ JSON.parse(t); localStorage.setItem('emtemplates.data',t); location.reload(); }
        catch{ alert('Invalid JSON'); }
      };
      inp.click();
    }
    if(cmd==='saveSite'){ status('Saved locally'); setTimeout(()=>status(''),1200); }
    if(cmd==='reset'){
      if(!confirm('Reset all local macros?')) return;
      localStorage.removeItem('emtemplates.data'); location.reload();
    }
  });

  // Repo settings
  const KEY='emtemplates.gh';
  const get=()=>({
    ghOwner:  document.getElementById('ghOwner').value.trim(),
    ghRepo:   document.getElementById('ghRepo').value.trim(),
    ghBranch: document.getElementById('ghBranch').value.trim()||'main',
    ghPath:   document.getElementById('ghPath').value.trim()||'index.html',
    ghToken:  document.getElementById('ghToken').value,
    ghAutoSync: document.getElementById('ghAutoSync').checked
  });
  const set=(cfg)=>{
    const S=(id,v)=>{ const el=document.getElementById(id); if(el && v!=null) el.value=v; };
    S('ghOwner',cfg.ghOwner); S('ghRepo',cfg.ghRepo); S('ghBranch',cfg.ghBranch||'main'); S('ghPath',cfg.ghPath||'index.html');
    if(cfg.ghToken!=null) document.getElementById('ghToken').value=cfg.ghToken;
    document.getElementById('ghAutoSync').checked=!!cfg.ghAutoSync;
  };
  try{
    const local=JSON.parse(localStorage.getItem(KEY)||'{}');
    set({ghOwner:'raquelvsuarezucf-dot',ghRepo:'ED-templates-RS',ghBranch:'main',ghPath:'index.html',ghToken:'',ghAutoSync:false,...local});
  }catch{}

  const status2 = (t)=>{ const el=document.getElementById('em-status'); if(el) el.textContent=t||''; };

  async function ghGet(owner,repo,branch,path,token){
    const url=`https://api.github.com/repos/${encodeURIComponent(owner)}/${encodeURIComponent(repo)}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(branch)}`;
    const res=await fetch(url,{headers: token?{Authorization:`Bearer ${token}`}:{}});
    if(!res.ok){ if(res.status===404) return null; throw new Error('GET '+res.status); }
    return res.json();
  }
  async function ghPut(owner,repo,branch,path,token,content,message){
    const existing=await ghGet(owner,repo,branch,path,token);
    const body={ message:message||`Update ${path}`, content:btoa(unescape(encodeURIComponent(content))), branch };
    if(existing&&existing.sha) body.sha=existing.sha;
    const url=`https://api.github.com/repos/${encodeURIComponent(owner)}/${encodeURIComponent(repo)}/contents/${encodeURIComponent(path)}`;
    const res=await fetch(url,{method:'PUT',headers:{'Content-Type':'application/json',...(token?{Authorization:`Bearer ${token}`}:{})},body:JSON.stringify(body)});
    if(!res.ok) throw new Error('PUT '+res.status);
    return res.json();
  }
  async function doSync(){
    const cfg=get();
    if(!cfg.ghOwner||!cfg.ghRepo||!cfg.ghPath||!cfg.ghToken){ alert('Missing repo settings or token'); return; }
    if(typeof window.githubSyncAutoSha==='function'){
      const html='<!DOCTYPE html>\n'+document.documentElement.outerHTML;
      await window.githubSyncAutoSha({ owner:cfg.ghOwner, repo:cfg.ghRepo, branch:cfg.ghBranch, dir:'', token:cfg.ghToken, filename:cfg.ghPath, content:html, message:'Sync from app' });
      status2('✅ Synced to GitHub'); return;
    }
    const html='<!DOCTYPE html>\n'+document.documentElement.outerHTML;
    await ghPut(cfg.ghOwner,cfg.ghRepo,cfg.ghBranch,cfg.ghPath,cfg.ghToken,html,'Sync from app');
    status2('✅ Synced to GitHub');
  }
  document.getElementById('em-save-repo').addEventListener('click', async ()=>{
    const cfg=get(); localStorage.setItem(KEY, JSON.stringify(cfg)); status2('Saved locally');
    try{
      const clean={ghOwner:cfg.ghOwner,ghRepo:cfg.ghRepo,ghBranch:cfg.ghBranch,ghPath:cfg.ghPath,ghAutoSync:!!cfg.ghAutoSync};
      await ghPut(cfg.ghOwner,cfg.ghRepo,cfg.ghBranch,'repo_settings.json',cfg.ghToken,JSON.stringify(clean,null,2),'Update repo_settings.json');
      status2('Saved locally + repo_settings.json updated');
    }catch(_){}
  });
  document.getElementById('em-sync').addEventListener('click', doSync);
  document.getElementById('em-sync-sha').addEventListener('click', doSync);
})();
</script>
<!-- ===== /Fix Pack ===== -->

";
      }
    }
  };
})();





<script>
(function(){
  // Ensure robust sync helper exists (auto‑SHA + state backup handler already patched earlier)
  function ready(f){ if(document.readyState!=='loading') f(); else document.addEventListener('DOMContentLoaded', f); }

  // Force Sync button injector — runs when Settings menu opens
  ready(function(){
    // Find the Settings trigger by text content (works across your current markup)
    const triggers = Array.from(document.querySelectorAll('button,[role="button"],.btn'));
    const settingsBtn = triggers.find(el => /(^|\s)settings(\s|$)/i.test((el.textContent||'').trim()));
    if(!settingsBtn) return;

    function insertForceSync(){
      // Find the open dropdown by matching known menu item text
      const menus = Array.from(document.querySelectorAll('div,ul,menu'));
      const menu = menus.find(el => {
        const txt = (el.textContent || '').toLowerCase();
        const st  = getComputedStyle(el);
        return (st.position === 'absolute' || st.position === 'fixed')
               && txt.includes('sync to repo now')
               && el.offsetParent !== null;
      });
      if(!menu || menu.__forceSyncInjected) return;

      // Create divider + item
      const hr = document.createElement('div');
      hr.style.borderTop = '1px solid rgba(15,38,64,.08)';
      hr.style.margin = '.5rem 0';

      const item = document.createElement('button');
      item.type = 'button';
      item.textContent = 'Force Sync (Auto‑SHA)';
      item.style.display = 'block';
      item.style.width = '100%';
      item.style.textAlign = 'left';
      item.style.padding = '.5rem .75rem';
      item.style.borderRadius = '0.75rem';
      item.style.cursor = 'pointer';
      item.style.border = '1px solid transparent';
      item.addEventListener('mouseover', ()=>{ item.style.background = 'rgba(15,38,64,.06)'; });
      item.addEventListener('mouseout',  ()=>{ item.style.background = 'transparent'; });

      // Click handler: build snapshot, then push with auto‑SHA (also does state backup via earlier patch)
      item.addEventListener('click', async function(e){
        e.preventDefault();
        try{
          if (typeof getRepoCfg !== 'function') throw new Error('Repo not configured');
          if (typeof buildHtmlSnapshot !== 'function') throw new Error('Snapshot unavailable');
          const cfg = getRepoCfg();
          const html = await (window.getSnapshotSafe ? window.getSnapshotSafe() : buildHtmlSnapshot()); // state is embedded inside snapshot by earlier patch
          // Use the robust sync function (exists from prior patch). Fall back to simple PUT if absent.
          if (typeof window.githubSyncAutoSha === 'function'){
            await window.githubSyncAutoSha({
              owner: cfg.owner, repo: cfg.repo, branch: cfg.branch, dir: cfg.dir || '',
              token: cfg.token, filename: 'index.html', content: html, message: 'Force sync from app'
            });
          } else {
            // Fallback: call the existing sync click if present
            const syncBtn = document.querySelector('#syncToRepoNowBtn,[data-sync-now]');
            if (syncBtn) syncBtn.click();
          }
          if (typeof showToast === 'function') showToast('✅ Force sync complete');
          else alert('✅ Force sync complete');
        }catch(err){
          alert((err && err.message) ? err.message : String(err));
        }
      });

      // Insert at the end of the menu
      menu.appendChild(hr);
      menu.appendChild(item);
      menu.__forceSyncInjected = true;
    }

    settingsBtn.addEventListener('click', ()=> setTimeout(insertForceSync, 60), true);
  });

  // Make sure normal "Sync to Repo Now" also uses auto‑SHA even if page script bound earlier
  ready(function(){
    document.addEventListener('click', function(e){
      const el = e.target.closest('#syncToRepoNowBtn,[data-sync-now]');
      if (!el) return;
      if (typeof window.githubSyncAutoSha !== 'function' || typeof getRepoCfg !== 'function' || typeof buildHtmlSnapshot !== 'function') return;
      e.stopPropagation();
      e.preventDefault();
      (async ()=>{
        const cfg = getRepoCfg();
        const html = await (window.getSnapshotSafe ? window.getSnapshotSafe() : buildHtmlSnapshot());
        try{
          await window.githubSyncAutoSha({
            owner: cfg.owner, repo: cfg.repo, branch: cfg.branch, dir: cfg.dir || '',
            token: cfg.token, filename: 'index.html', content: html, message: 'Sync from app'
          });
          if (typeof showToast === 'function') showToast('✅ Synced to GitHub');
          else alert('✅ Synced to GitHub');
        }catch(err){
          alert((err && err.message) ? err.message : String(err));
        }
      })();
    }, true);
  });
})();
</script>


<script>
(function(){
  function domReadyPromise(){
    if (document.readyState === 'complete' || document.readyState === 'interactive') {
      return Promise.resolve();
    }
    return new Promise(res => document.addEventListener('DOMContentLoaded', res, { once: true }));
  }
  async function makeSnapshotGuaranteed(){
    // Ensure DOM is there
    await domReadyPromise();
    // small delay to allow any hydration/layout microtasks
    await new Promise(r => setTimeout(r, 300));

    // Try the app-provided builders first
    try{
      if (typeof buildHtmlSnapshot === 'function'){
        return buildHtmlSnapshot();
      }
    }catch(e){}
    try{
      if (typeof exportHtmlSnapshot === 'function'){
        return exportHtmlSnapshot();
      }
    }catch(e){}

    // Robust DOM serialization fallbacks
    try{
      // Prefer XMLSerializer to avoid missing doctype or malformed nodes
      var serializer = new XMLSerializer();
      var html = serializer.serializeToString(document);
      if (!/^<!DOCTYPE/i.test(html)) {
        // Prepend doctype if XMLSerializer omitted it
        var dt = "<!doctype html>";
        if (document.doctype) {
          var n = document.doctype.name || "html";
          var pub = document.doctype.publicId ? ' PUBLIC "' + document.doctype.publicId + '"' : '';
          var sys = document.doctype.systemId ? (document.doctype.publicId ? ' "' + document.doctype.systemId + '"' : ' SYSTEM "' + document.doctype.systemId + '"') : '';
          dt = "<!DOCTYPE " + n + pub + sys + ">";
        }
        html = dt + "\\n" + html;
      }
      if (typeof embedRvsredState === 'function') {
        try { html = embedRvsredState(html); } catch(e){}
      }
      return html;
    }catch(e){}

    try{
      var base = "<!doctype html>\\n" + (document.documentElement ? document.documentElement.outerHTML : "<html></html>");
      if (typeof embedRvsredState === 'function') {
        try { base = embedRvsredState(base); } catch(e){}
      }
      return base;
    }catch(e){}

    // Absolute fallback – should never be reached
    return "<!doctype html><html><head><meta charset='utf-8'></head><body>Snapshot Fallback</body></html>";
  }

  // Upgrade Force Sync click to always use guaranteed snapshot
  document.addEventListener('click', function(e){
    const el = e.target.closest('button');
    if (!el) return;
    if (!/force sync/i.test(el.textContent || '')) return;
    if (typeof window.githubSyncAutoSha !== 'function' || typeof getRepoCfg !== 'function') return;

    e.preventDefault();
    e.stopPropagation();

    (async ()=>{
      try{
        const cfg = getRepoCfg();
        const html = await makeSnapshotGuaranteed();
        await window.githubSyncAutoSha({
          owner: cfg.owner, repo: cfg.repo, branch: cfg.branch, dir: cfg.dir || '',
          token: cfg.token, filename: 'index.html', content: html, message: 'Force sync from app'
        });
        if (typeof showToast === 'function') showToast('✅ Force sync complete');
        else alert('✅ Force sync complete');
      }catch(err){
        alert((err && err.message) ? err.message : String(err));
      }
    })();
  }, true);

  // Route normal "Sync to Repo Now" through the same safe path
  document.addEventListener('click', function(e){
    const el = e.target.closest('#syncToRepoNowBtn,[data-sync-now]');
    if (!el) return;
    if (typeof window.githubSyncAutoSha !== 'function' || typeof getRepoCfg !== 'function') return;

    e.preventDefault();
    e.stopPropagation();

    (async ()=>{
      try{
        const cfg = getRepoCfg();
        const html = await makeSnapshotGuaranteed();
        await window.githubSyncAutoSha({
          owner: cfg.owner, repo: cfg.repo, branch: cfg.branch, dir: cfg.dir || '',
          token: cfg.token, filename: 'index.html', content: html, message: 'Sync from app'
        });
        if (typeof showToast === 'function') showToast('✅ Synced to GitHub');
        else alert('✅ Synced to GitHub');
      }catch(err){
        alert((err && err.message) ? err.message : String(err));
      }
    })();
  }, true);
})();
</script>
</body></html>